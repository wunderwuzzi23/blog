<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Cookies on Embrace The Red</title>
    <link>http://localhost:1313/blog/tags/cookies/</link>
    <description>Recent content in Cookies on Embrace The Red</description>
    <generator>Hugo</generator>
    <language>en-us</language>
    <copyright>(c) WUNDERWUZZI 2018-2026</copyright>
    <lastBuildDate>Thu, 08 Jan 2026 02:20:58 -0700</lastBuildDate>
    <atom:link href="http://localhost:1313/blog/tags/cookies/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Minting Next.js Authentication Cookies</title>
      <link>http://localhost:1313/blog/posts/2026/minting-next-auth-nextjs-auth-cookies-react2shell-threat/</link>
      <pubDate>Thu, 08 Jan 2026 02:20:58 -0700</pubDate>
      <guid>http://localhost:1313/blog/posts/2026/minting-next-auth-nextjs-auth-cookies-react2shell-threat/</guid>
      <description>&lt;p&gt;In this post, we&amp;rsquo;ll look how an adversary can mint authentication cookies for Next.js (&lt;code&gt;next-auth/Auth.js&lt;/code&gt;) applications to maintain persistent access to the application as any user.&lt;/p&gt;&#xA;&lt;p&gt;The reason this is important is because of &lt;code&gt;React2Shell&lt;/code&gt;, which is a deserialization vulnerability that allows an adversary to run arbitrary code. Much has been discussed about this vulnerability, and you can read up the original details from the finder &lt;a href=&#34;https://react2shell.com/&#34;&gt;here&lt;/a&gt;.&lt;/p&gt;&#xA;&lt;h3 id=&#34;exploitation-of-react2shell&#34;&gt;Exploitation of React2Shell&lt;/h3&gt;&#xA;&lt;p&gt;One of the challenges for defenders is that there is little evidence left behind when exploitation occurs.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Pivot to the Clouds: Cookie Theft in 2024</title>
      <link>http://localhost:1313/blog/posts/2024/cookie-theft-in-2024-and-what-todo/</link>
      <pubDate>Thu, 16 May 2024 00:00:11 -0800</pubDate>
      <guid>http://localhost:1313/blog/posts/2024/cookie-theft-in-2024-and-what-todo/</guid>
      <description>&lt;p&gt;Recently Google published a blog about &lt;a href=&#34;https://security.googleblog.com/2024/04/detecting-browser-data-theft-using.html&#34;&gt;detecting browser data theft using Windows Event Logs&lt;/a&gt;.&lt;/p&gt;&#xA;&lt;p&gt;There are some good points in the post for defenders on how to detect misuse of &lt;code&gt;DPAPI&lt;/code&gt; calls attempting to grab sensitive browser data.&lt;/p&gt;&#xA;&lt;h2 id=&#34;but-what-about-the-remote-debugging-feature&#34;&gt;But, what about the Remote Debugging feature?&lt;/h2&gt;&#xA;&lt;p&gt;This made me curious to revisit the state of the remote debugging feature of browsers for grabbing sensitive information, including cookies.&lt;/p&gt;&#xA;&lt;p&gt;We discussed cookie theft techniques &lt;a href=&#34;https://embracethered.com/blog/posts/2020/firefox-cookie-debug-client/&#34;&gt;in&lt;/a&gt; &lt;a href=&#34;https://embracethered.com/blog/posts/2020/cookie-crimes-on-mirosoft-edge/&#34;&gt;the&lt;/a&gt; &lt;a href=&#34;https://embracethered.com/blog/posts/2020/2600-hacker-pass-the-cookie/&#34;&gt;past&lt;/a&gt;, even &lt;a href=&#34;https://embracethered.com/blog/posts/passthecookie/&#34;&gt;presented about it at the CCC&lt;/a&gt; some 5+ years ago and helped add the TTP to the &lt;a href=&#34;https://attack.mitre.org/techniques/T1539/&#34;&gt;MITRE ATT&amp;amp;CK matrix&lt;/a&gt;.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Firefox - Debugger Client for Cookie Access</title>
      <link>http://localhost:1313/blog/posts/2020/firefox-cookie-debug-client/</link>
      <pubDate>Tue, 21 Jul 2020 11:00:15 -0700</pubDate>
      <guid>http://localhost:1313/blog/posts/2020/firefox-cookie-debug-client/</guid>
      <description>&lt;p&gt;Finally I got to writing some basic tooling for invoking the Firefox debugging API to send commands to the browser and read the responses. This can be useful for grabbing cookies in the post-exploitation phase.&lt;/p&gt;&#xA;&lt;p&gt;It works for &lt;code&gt;Windows&lt;/code&gt; and &lt;code&gt;macOS&lt;/code&gt;, should also work on &lt;code&gt;Linux&lt;/code&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;http://localhost:1313/blog/images/2020/firefox/output.png&#34;&gt;&lt;img src=&#34;http://localhost:1313/blog/images/2020/firefox/output.png&#34; alt=&#34;ffcm output filtered by google.com&#34;&gt;&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;This technique is probably most useful when we don&amp;rsquo;t have root or the user&amp;rsquo;s credentials to decrypt cookies or can&amp;rsquo;t attach a regular debugger to the browser process.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Remotely debugging Firefox instances</title>
      <link>http://localhost:1313/blog/posts/2020/cookies-on-firefox/</link>
      <pubDate>Wed, 15 Jul 2020 06:00:00 -0700</pubDate>
      <guid>http://localhost:1313/blog/posts/2020/cookies-on-firefox/</guid>
      <description>&lt;p&gt;Previously I talked about &lt;a href=&#34;http://localhost:1313/blog/posts/2020/chrome-spy-remote-control&#34;&gt;remotely debugging Chrome&lt;/a&gt;, and we also covered the &lt;a href=&#34;http://localhost:1313/blog/posts/2020/cookie-crimes-on-microsoft-edge&#34;&gt;latest Microsoft Edge browser&lt;/a&gt; along the way.&lt;/p&gt;&#xA;&lt;p&gt;These features allow an adversary to gain access to authentication tokens and cookies. See &lt;a href=&#34;https://attack.mitre.org/techniques/T1539/&#34;&gt;MITRE ATT&amp;amp;CK Technique T1539: Steal Web Session Cookie&lt;/a&gt; as well for this.&lt;/p&gt;&#xA;&lt;h2 id=&#34;what-about-firefox&#34;&gt;What about Firefox?&lt;/h2&gt;&#xA;&lt;p&gt;For a while I was wondering if (my favorite) browser Firefox has such debugging features as well, and how one could detect malware trying to exploit it.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Cookie Crimes and the new Microsoft Edge Browser</title>
      <link>http://localhost:1313/blog/posts/2020/cookie-crimes-on-mirosoft-edge/</link>
      <pubDate>Fri, 01 May 2020 01:00:46 -0700</pubDate>
      <guid>http://localhost:1313/blog/posts/2020/cookie-crimes-on-mirosoft-edge/</guid>
      <description>&lt;h2 id=&#34;revisiting-cookie-crimes&#34;&gt;Revisiting Cookie Crimes&lt;/h2&gt;&#xA;&lt;p&gt;In 2018 &lt;em&gt;@mangopdf&lt;/em&gt; described &amp;ldquo;Cookie Crimes&amp;rdquo;, which is great research around Chrome&amp;rsquo;s remote debugging feature that allows adversaries and malware to gain access to cookies quite convienently during post-exploitation.&lt;/p&gt;&#xA;&lt;p&gt;The original research is published &lt;a href=&#34;https://mango.pdf.zone/stealing-chrome-cookies-without-a-password&#34;&gt;here&lt;/a&gt;, and it still works today.&lt;/p&gt;&#xA;&lt;h2 id=&#34;the-new-microsoft-edge-browser-and-chromium&#34;&gt;The new Microsoft Edge browser and Chromium&lt;/h2&gt;&#xA;&lt;p&gt;Microsoft&amp;rsquo;s latest Edge browser is based on the same code, Chromium. I guess, you already know where this is going now&amp;hellip;&lt;/p&gt;</description>
    </item>
    <item>
      <title>Post-Exploitation: Abusing Chrome&#39;s debugging feature to observe and control browsing sessions remotely</title>
      <link>http://localhost:1313/blog/posts/2020/chrome-spy-remote-control/</link>
      <pubDate>Tue, 28 Apr 2020 18:00:00 -0700</pubDate>
      <guid>http://localhost:1313/blog/posts/2020/chrome-spy-remote-control/</guid>
      <description>&lt;p&gt;Chrome&amp;rsquo;s remote debugging feature enables malware post-exploitation to gain access to cookies. Root privileges are not required. This is a pretty well-known and commonly used adversarial technique - at least since 2018 when &lt;strong&gt;Cookie Crimes&lt;/strong&gt; was released.&lt;/p&gt;&#xA;&lt;p&gt;However, remote debugging also &lt;strong&gt;allows observing user activities and sensitive personal information (aka spying on users) and controlling the browser from a remote computer&lt;/strong&gt;.&lt;/p&gt;&#xA;&lt;p&gt;&lt;img src=&#34;http://localhost:1313/blog/images/2020/hacker.png&#34; alt=&#34;Hacker&#34;&gt;&lt;/p&gt;&#xA;&lt;p&gt;Below screenshot shows a simulated attacker controlling the victim&amp;rsquo;s browser and navigating to &lt;em&gt;chrome://settings&lt;/em&gt; to inspect information:&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
