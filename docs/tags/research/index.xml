<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Research on Embrace The Red</title>
    <link>https://embracethered.com/blog/tags/research/</link>
    <description>Recent content in Research on Embrace The Red</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <copyright>(c) WUNDERWUZZI 2018-2025</copyright>
    <lastBuildDate>Sat, 02 Mar 2024 22:25:17 -0800</lastBuildDate>
    <atom:link href="https://embracethered.com/blog/tags/research/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Who Am I? Conditional Prompt Injection Attacks with Microsoft Copilot</title>
      <link>https://embracethered.com/blog/posts/2024/whoami-conditional-prompt-injection-instructions/</link>
      <pubDate>Sat, 02 Mar 2024 22:25:17 -0800</pubDate>
      <guid>https://embracethered.com/blog/posts/2024/whoami-conditional-prompt-injection-instructions/</guid>
      <description>Building reliable prompt injection payloads is challenging at times. It&amp;rsquo;s this new world with large language model (LLM) applications that can be instructed with natural language and they mostly follow instructions&amp;hellip; but not always.&#xA;Attackers have the same challenges around prompt engineering as normal users.&#xA;Prompt Injection Exploit Development Attacks always get better over time. And as more features are being added to LLM applications, the degrees of freedom for attackers increases as well.</description>
    </item>
    <item>
      <title>Ropci deep-dive for Azure hackers</title>
      <link>https://embracethered.com/blog/posts/2022/ropci-usage/</link>
      <pubDate>Sun, 20 Nov 2022 18:00:00 -0700</pubDate>
      <guid>https://embracethered.com/blog/posts/2022/ropci-usage/</guid>
      <description>Misconfigurations with MFA setups are not uncommon when using AAD, especially when federated setups or Pass Through Authentication is configured I have seen MFA bypass opportunities in multiple production tenants.&#xA;A common misconfiguration is that MFA is enforced at the federated identity provider, but AAD is forgotten and ROPC authentication still succeeds against AAD.&#xA;To learn more about ROPC, check out the previous post about the topic.&#xA;This post focuses on the ropci features that can be leveraged post-exploitation.</description>
    </item>
    <item>
      <title>PenTest Magazine Open Source Toolkit: ropci</title>
      <link>https://embracethered.com/blog/posts/2022/ropci-pentest-magazine-open-source-tools/</link>
      <pubDate>Thu, 20 Oct 2022 09:00:10 -0700</pubDate>
      <guid>https://embracethered.com/blog/posts/2022/ropci-pentest-magazine-open-source-tools/</guid>
      <description>Great news!&#xA;An article about ropci is in the latest free issue of the Pentest Magazine!&#xA;The article has a lot more info then my ropci blog post or the info on the ropci Github repo.&#xA;Get your copy and check it out! It also has an article about Nuclei, one of my favorite tools.&#xA;Cheers.&#xA;Link: https://pentestmag.com/product/pentest-open-source-pentesting-toolkit</description>
    </item>
    <item>
      <title>ROPC - So, you think you have MFA?</title>
      <link>https://embracethered.com/blog/posts/2022/ropci-so-you-think-you-have-mfa-azure-ad/</link>
      <pubDate>Thu, 20 Oct 2022 08:00:00 -0700</pubDate>
      <guid>https://embracethered.com/blog/posts/2022/ropci-so-you-think-you-have-mfa-azure-ad/</guid>
      <description>This post will highlight a pattern I have seen across multiple production Microsoft Azure Active Directory tenants which led to MFA bypasses using ROPC.&#xA;The key take-away: Always enforce MFA! Sounds easy, but there are often misconfigurations and unexpected exceptions. So, test your own AAD tenant for ROPC based MFA bypass opportunities.&#xA;Github: https://github.com/wunderwuzzi23/ropci&#xA;Update: The latest free issue of Pentest Magazine has a ropci article. Check it out.&#xA;What is ROPC?</description>
    </item>
    <item>
      <title>Malicious Python Packages and Code Execution via pip download</title>
      <link>https://embracethered.com/blog/posts/2022/python-package-manager-install-and-download-vulnerability/</link>
      <pubDate>Fri, 09 Sep 2022 16:30:29 -0700</pubDate>
      <guid>https://embracethered.com/blog/posts/2022/python-package-manager-install-and-download-vulnerability/</guid>
      <description>This week I learned about a design flaw with pip download, which allows an adversary to run arbitrary code.&#xA;I assumed that running pip install means anything could happen, but pip download seems a bit surprising.&#xA;Both seem useful for red teaming though.&#xA;Background This post from Yehuda Gelb named Automatic Execution of Code Upon Package Download on Python Package Manager which the Security Now! podcast pointed me towards.&#xA;The post highlights that just running pip download can compromise your computer.</description>
    </item>
    <item>
      <title>Offensive BPF: Using bpftrace to sniff PAM logon passwords</title>
      <link>https://embracethered.com/blog/posts/2022/offensive-bpf-bpftrace-sniff-logon-pam-passwords/</link>
      <pubDate>Sun, 10 Jul 2022 20:00:13 -0700</pubDate>
      <guid>https://embracethered.com/blog/posts/2022/offensive-bpf-bpftrace-sniff-logon-pam-passwords/</guid>
      <description>This post is part of a series about Offensive BPF. Click the &amp;ldquo;ebpf&amp;rdquo; tag to see all related posts.&#xA;It has been a while that we posted something in the &amp;ldquo;Offensive BPF&amp;rdquo; series. But recently there have been a couple of new cool ebpf based tools, such as TripleCross, boopkit and pamspy.&#xA;So, I thought it be quite fitting to do another post in the Offensive BPF series to keep raising awareness.</description>
    </item>
    <item>
      <title>Post Exploitation: Sniffing Logon Passwords with PAM</title>
      <link>https://embracethered.com/blog/posts/2022/post-exploit-pam-ssh-password-grabbing/</link>
      <pubDate>Sun, 26 Jun 2022 22:50:18 -0800</pubDate>
      <guid>https://embracethered.com/blog/posts/2022/post-exploit-pam-ssh-password-grabbing/</guid>
      <description>Pluggable Authentication Modules (PAM) on Unix based systems are useful to change logon behavior and enforce authentication via various means.&#xA;In &amp;ldquo;Red Team Strategies&amp;rdquo; the chapter &amp;ldquo;Protecting the Pentester&amp;rdquo; walks the reader through the configuration of a PAM module to get notified in real-time via a pop-up when someone logs on to the machine (e.g. system compromise).&#xA;But there are also bad things that can be done with PAM (especially post-exploitation) and this is what this post is about.</description>
    </item>
    <item>
      <title>Grabbing and cracking macOS hashes</title>
      <link>https://embracethered.com/blog/posts/2022/grabbing-and-cracking-macos-hashes/</link>
      <pubDate>Sun, 03 Apr 2022 10:46:07 -0700</pubDate>
      <guid>https://embracethered.com/blog/posts/2022/grabbing-and-cracking-macos-hashes/</guid>
      <description>Information for red teaming macOS and info on real world TTPs are still a bit sparse. That makes it difficult for defenders to know what attackers do on macOS compared to Windows. Some organizations might have a bigger blind spot when it comes to macOS.&#xA;This post describes how an adversary can grab hashes from a macOS machine, how to convert it to a hashcat friendly format and use hashcat to crack it.</description>
    </item>
    <item>
      <title>Flipper Zero - Initial Thoughts</title>
      <link>https://embracethered.com/blog/posts/2022/flipper-zero-intro/</link>
      <pubDate>Fri, 18 Mar 2022 23:58:26 -0700</pubDate>
      <guid>https://embracethered.com/blog/posts/2022/flipper-zero-intro/</guid>
      <description>After a bit of a delay my Flipper Zero finally arrived in the mail. If you are not familiar with Flipper Zero at all, check out the original Kickstarter page from a few years back.&#xA;This is what the package looks like after opening. It contains the device, a USB cable, a quick start manual (mostly pointing you to the Flipper Zero website), and a Flipper &amp;ldquo;Hack the planet&amp;rdquo; sticker.</description>
    </item>
    <item>
      <title>Gitlab Reconnaissance Introduction</title>
      <link>https://embracethered.com/blog/posts/2022/hacking-gitlab-servers/</link>
      <pubDate>Mon, 28 Feb 2022 04:22:22 -0700</pubDate>
      <guid>https://embracethered.com/blog/posts/2022/hacking-gitlab-servers/</guid>
      <description>Although Gitlab is not as popular as Github, itâ€™s common to run across it these days. Especially after Microsoft acquired Github it seemed more individuals and organizations flocked over to Gitlab.&#xA;In this post I want to document a couple of recon commands that are useful post-exploitation, and for blue teamers to watch out for.&#xA;Let&amp;rsquo;s assume one has access to a Gitlab Token as a precursor. Let&amp;rsquo;s walk through some interesting commands and script snippets to leverage to find out more.</description>
    </item>
    <item>
      <title>Log4Shell and Request Forgery Attacks</title>
      <link>https://embracethered.com/blog/posts/2022/log4shell-and-request-forgery-attacks/</link>
      <pubDate>Tue, 04 Jan 2022 15:18:18 -0800</pubDate>
      <guid>https://embracethered.com/blog/posts/2022/log4shell-and-request-forgery-attacks/</guid>
      <description>The last weeks of 2021 got quite interesting for security professionals and software engineers.&#xA;Apache&amp;rsquo;s log4j library and its now prominent Java Naming and Directory Interface support, which enables easy remote code execution, made the news across the industry.&#xA;What makes Log4Shell scary is the widespread adoption of the Log4j library amongst Java applications, and the ease of remote exploitation.&#xA;A dangerous combination.&#xA;Patches got released, bypasses were discovered more patches were released and so forth.</description>
    </item>
    <item>
      <title>Offensive BPF: Understanding and using bpf_probe_write_user</title>
      <link>https://embracethered.com/blog/posts/2021/offensive-bpf-libbpf-bpf_probe_write_user/</link>
      <pubDate>Wed, 20 Oct 2021 00:04:40 -0700</pubDate>
      <guid>https://embracethered.com/blog/posts/2021/offensive-bpf-libbpf-bpf_probe_write_user/</guid>
      <description>This post is part of a series about Offensive BPF to learn how BPFs use will impact offensive security, malware, and detection engineering.&#xA;Click the &amp;ldquo;ebpf&amp;rdquo; tag to see all relevant posts.&#xA;Building advanced BPF programs So far in this Offensive BPF series the focus was on bpftrace to build and run BPF programs.&#xA;The next thing I wanted to investigate is what options are available to modify data structures during BPF execution.</description>
    </item>
    <item>
      <title>Offensive BPF: Sniffing Firefox traffic with bpftrace</title>
      <link>https://embracethered.com/blog/posts/2021/offensive-bpf-sniffing-traffic-bpftrace/</link>
      <pubDate>Thu, 14 Oct 2021 00:10:16 -0700</pubDate>
      <guid>https://embracethered.com/blog/posts/2021/offensive-bpf-sniffing-traffic-bpftrace/</guid>
      <description>This post is part of a series about Offensive BPF that I&amp;rsquo;m working on to learn how BPFs use will impact offensive security, malware, and detection engineering.&#xA;Click the &amp;ldquo;ebpf&amp;rdquo; tag to see all relevant posts.&#xA;One of the issues I ran into when trying out sslsniff-bpfcc was that it did not work with Firefox or Chrome traffic.&#xA;This post is about me learning how to hook user space APIs with bpftrace using uprobes.</description>
    </item>
    <item>
      <title>Offensive BPF: What&#39;s in the bpfcc-tools box?</title>
      <link>https://embracethered.com/blog/posts/2021/offensive-bpf-handy-tools/</link>
      <pubDate>Sat, 09 Oct 2021 14:00:59 -0700</pubDate>
      <guid>https://embracethered.com/blog/posts/2021/offensive-bpf-handy-tools/</guid>
      <description>This post is part of a series about Offensive BPF that I&amp;rsquo;m working on to learn about BPF to understand attacks and defenses. Click the &amp;ldquo;ebpf&amp;rdquo; tag to see all relevant posts.&#xA;In the previous posts I spend time learning about bpftrace which is quite powerful. This post is focused on basics and using existing BPF tools, rather then building new BPF programs from scratch.&#xA;Living off the land: bpfcc-tools Performance and observability teams are pushing for BPF tooling to be present in production.</description>
    </item>
    <item>
      <title>Offensive BPF: Detection Ideas</title>
      <link>https://embracethered.com/blog/posts/2021/offensive-bpf-detections-initial-ideas/</link>
      <pubDate>Thu, 07 Oct 2021 08:00:00 -0700</pubDate>
      <guid>https://embracethered.com/blog/posts/2021/offensive-bpf-detections-initial-ideas/</guid>
      <description>This post is part of a series about Offensive BPF that I&amp;rsquo;m working on to learn how BPFs use will impact offensive security, malware and detection engineering.&#xA;Click the &amp;ldquo;ebpf&amp;rdquo; tag to see all relevant posts.&#xA;In the last few posts, we talked about a bpftrace and how attackers can use it to their advantage. This post is about my initial ideas and strategies to detecting malicious usage.&#xA;Detecting BPF misuse There are a set of detection ideas for Blue Teams.</description>
    </item>
    <item>
      <title>Offensive BPF: Using bpftrace to host backdoors</title>
      <link>https://embracethered.com/blog/posts/2021/offensive-bpf-bpftrace-message-based/</link>
      <pubDate>Wed, 06 Oct 2021 20:00:13 -0700</pubDate>
      <guid>https://embracethered.com/blog/posts/2021/offensive-bpf-bpftrace-message-based/</guid>
      <description>This post is part of a series about Offensive BPF that I&amp;rsquo;m working on to learn how BPFs use will impact offensive security, malware and detection engineering. Click the &amp;ldquo;ebpf&amp;rdquo; tag to see all relevant posts.&#xA;In the last post we talked about a basic bpftrace script to install a BPF program that runs commands upon connecting from a specific IP with a specific magic source port.&#xA;This post will dive into this idea more by leveraging more a complex solution.</description>
    </item>
    <item>
      <title>Offensive BPF: Malicious bpftrace ðŸ¤¯</title>
      <link>https://embracethered.com/blog/posts/2021/offensive-bpf-bpftrace/</link>
      <pubDate>Tue, 05 Oct 2021 08:00:58 -0700</pubDate>
      <guid>https://embracethered.com/blog/posts/2021/offensive-bpf-bpftrace/</guid>
      <description>This post is part of a series about Offensive BPF that I&amp;rsquo;m working on to learn about BPF to understand attacks and defenses, click the &amp;ldquo;ebpf&amp;rdquo; tag to see all relevant posts.&#xA;I&amp;rsquo;m learning BPF to understand how its use will impact offensive security, malware, and detection engineering.&#xA;One offsec idea that quickly comes to mind with BPF is to observe network traffic and act upon specific events. So, I wanted to see if/how bpftrace, a popular tool for running BPF programs, can be used to create potential backdoors, and what evidence to look for as defenders.</description>
    </item>
    <item>
      <title>Offensive BPF! Getting started.</title>
      <link>https://embracethered.com/blog/posts/2021/offensive-bpf/</link>
      <pubDate>Thu, 30 Sep 2021 00:00:00 -0700</pubDate>
      <guid>https://embracethered.com/blog/posts/2021/offensive-bpf/</guid>
      <description>Over the last few years eBPF has gained a lot of traction in the Linux community and beyond.&#xA;eBPF&amp;rsquo;s offensive usage is also slowly getting more attention. So, I decided to dive into the topic from a red teaming point of view to learn about it to raise awareness and share the journey.&#xA;Similar to the format of my Machine Learning Attack Series, there will be a serious of posts around BPF usage in offensive settings, and also how its misuse can be detected.</description>
    </item>
    <item>
      <title>Abusing Application Layer Gateways (NAT Slipstreaming)</title>
      <link>https://embracethered.com/blog/posts/2020/nat-slipstreaming-simplified/</link>
      <pubDate>Mon, 23 Nov 2020 23:00:57 -0800</pubDate>
      <guid>https://embracethered.com/blog/posts/2020/nat-slipstreaming-simplified/</guid>
      <description>You might have heard about &amp;ldquo;NAT Slipstreaming&amp;rdquo; by Samy Kamkar. It&amp;rsquo;s an amazing technique that allows punching a hole in your routers firewall by just visiting a website.&#xA;The attack depends on the router having the Application Layer Gateway enabled. This gateway can be used by anyone inside your network to open a firewall port (totally by design). Protocols such as SIP (Session Initiation Protocol) use it.&#xA;What I will focus on in this post is the Application Layer Gateway (ALG) and SIP.</description>
    </item>
    <item>
      <title>Race conditions when applying ACLs</title>
      <link>https://embracethered.com/blog/posts/2020/applying-acls-and-race-conditions/</link>
      <pubDate>Mon, 24 Aug 2020 12:00:33 -0800</pubDate>
      <guid>https://embracethered.com/blog/posts/2020/applying-acls-and-race-conditions/</guid>
      <description>Today I&amp;rsquo;m gonna talk about a class of application security issues I ran across a few times over the years. In particular, let&amp;rsquo;s discuss race conditions when it comes to files with sensitive content and permissions.&#xA;Race conditions can allow an adversary to gain access to sensitive information on machines. Assume a system creates a file that contains sensitive information and afterwards applies permissions to lockdown that file.&#xA;Understanding the race condition Let&amp;rsquo;s look at a practical example seen in the wild a few times.</description>
    </item>
    <item>
      <title>2600 - The Hacker Quarterly - Pass the Cookie Article</title>
      <link>https://embracethered.com/blog/posts/2020/2600-hacker-pass-the-cookie/</link>
      <pubDate>Sat, 15 Feb 2020 15:48:51 -0800</pubDate>
      <guid>https://embracethered.com/blog/posts/2020/2600-hacker-pass-the-cookie/</guid>
      <description>Pass the Cookie made it into the latest 2600 magazine! Very excited about this!&#xA;I was just walking around Capitol Hill and stopped by Ada&amp;rsquo;s Technical Books on 15th Avenue - a great coffee shop with lots of technical books. Right after walking in to grab a cup of tea, I saw the latest Hacker Quarterly. A few months back I submitted an article about &amp;ldquo;Pass the Cookie&amp;rdquo;, so I had to check, and the article got indeed published!</description>
    </item>
    <item>
      <title>Active Directory and MacOS</title>
      <link>https://embracethered.com/blog/posts/active-directory-and-macos/</link>
      <pubDate>Thu, 20 Jun 2019 22:00:16 -0700</pubDate>
      <guid>https://embracethered.com/blog/posts/active-directory-and-macos/</guid>
      <description>Interacting with Active Directory on the Mac Did you ever have to interact with Active Directory on a MAC?&#xA;If yes, this post might be interesting for you. I am pretty new to the Mac and basic things I know how to do on Windows need some research to figure out. This time around I explore Active Directory/LDAP Server interactions.&#xA;First, there is the Directory Utility on MacOS which can be quite useful.</description>
    </item>
    <item>
      <title>Google Leaks Your Alternate Email Addresses to Unauthenticated Users</title>
      <link>https://embracethered.com/blog/posts/google-email-leak/</link>
      <pubDate>Tue, 04 Jun 2019 21:51:52 -0700</pubDate>
      <guid>https://embracethered.com/blog/posts/google-email-leak/</guid>
      <description>The Google Login Flow leaks additional email account information to unauthenticated users. I discovered this in the Google Account Login flow while building KoiPhish.&#xA;Responsible Disclosure I reported this issue to Google and they looked into it and after a about 5 weeks of back and forth they decided that this is not an issue worth fixing. After asking if I can post about it publicly I got Google&amp;rsquo;s okay.</description>
    </item>
  </channel>
</rss>
