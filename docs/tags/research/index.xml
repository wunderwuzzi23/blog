<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Research on Embrace The Red</title>
    <link>https://embracethered.com/blog/tags/research/</link>
    <description>Recent content in Research on Embrace The Red</description>
    <generator>Hugo</generator>
    <language>en-us</language>
    <copyright>(c) WUNDERWUZZI 2018-2026</copyright>
    <lastBuildDate>Sat, 02 Mar 2024 22:25:17 -0800</lastBuildDate>
    <atom:link href="https://embracethered.com/blog/tags/research/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Who Am I? Conditional Prompt Injection Attacks with Microsoft Copilot</title>
      <link>https://embracethered.com/blog/posts/2024/whoami-conditional-prompt-injection-instructions/</link>
      <pubDate>Sat, 02 Mar 2024 22:25:17 -0800</pubDate>
      <guid>https://embracethered.com/blog/posts/2024/whoami-conditional-prompt-injection-instructions/</guid>
      <description>&lt;p&gt;Building reliable prompt injection payloads is challenging at times. It&amp;rsquo;s this new world with large language model (LLM) applications that can be instructed with natural language and they mostly follow instructions&amp;hellip; but not always.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Attackers have the same challenges around prompt engineering as normal users.&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;h2 id=&#34;prompt-injection-exploit-development&#34;&gt;Prompt Injection Exploit Development&lt;/h2&gt;&#xA;&lt;p&gt;Attacks always get better over time. And as more features are being added to LLM applications, the degrees of freedom for attackers increases as well.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Ropci deep-dive for Azure hackers</title>
      <link>https://embracethered.com/blog/posts/2022/ropci-usage/</link>
      <pubDate>Sun, 20 Nov 2022 18:00:00 -0700</pubDate>
      <guid>https://embracethered.com/blog/posts/2022/ropci-usage/</guid>
      <description>&lt;p&gt;Misconfigurations with MFA setups are not uncommon when using AAD, especially when federated setups or Pass Through Authentication is configured I have seen MFA bypass opportunities in multiple production tenants.&lt;/p&gt;&#xA;&lt;p&gt;A common misconfiguration is that MFA is enforced at the federated identity provider, but AAD is forgotten and ROPC authentication still succeeds against AAD.&lt;/p&gt;&#xA;&lt;p&gt;To learn more about ROPC, check out the &lt;a href=&#34;https://embracethered.com/blog/posts/2022/ropci-so-you-think-you-have-mfa-azure-ad/&#34;&gt;previous post about the topic&lt;/a&gt;.&lt;/p&gt;&#xA;&lt;p&gt;This post focuses on the &lt;code&gt;ropci&lt;/code&gt; features that can be leveraged post-exploitation.&lt;/p&gt;</description>
    </item>
    <item>
      <title>PenTest Magazine Open Source Toolkit: ropci</title>
      <link>https://embracethered.com/blog/posts/2022/ropci-pentest-magazine-open-source-tools/</link>
      <pubDate>Thu, 20 Oct 2022 09:00:10 -0700</pubDate>
      <guid>https://embracethered.com/blog/posts/2022/ropci-pentest-magazine-open-source-tools/</guid>
      <description>&lt;p&gt;Great news!&lt;/p&gt;&#xA;&lt;p&gt;An article about &lt;code&gt;ropci&lt;/code&gt; is in the latest free issue of the Pentest Magazine!&lt;/p&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://pentestmag.com/product/pentest-open-source-pentesting-toolkit/&#34;&gt;&lt;img src=&#34;https://embracethered.com/blog/images/2022/ropci-pentest-magazine.png&#34; alt=&#34;pentest magazine&#34;&gt;&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;The article has a lot more info then my ropci blog post or the info on the &lt;a href=&#34;https://github.com/wunderwuzzi23/ropci&#34;&gt;ropci Github repo&lt;/a&gt;.&lt;/p&gt;&#xA;&lt;p&gt;Get your copy and check it out! It also has an article about Nuclei, one of my favorite tools.&lt;/p&gt;&#xA;&lt;p&gt;Cheers.&lt;/p&gt;&#xA;&lt;p&gt;Link: &lt;a href=&#34;https://pentestmag.com/product/pentest-open-source-pentesting-toolkit&#34;&gt;https://pentestmag.com/product/pentest-open-source-pentesting-toolkit&lt;/a&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>ROPC - So, you think you have MFA?</title>
      <link>https://embracethered.com/blog/posts/2022/ropci-so-you-think-you-have-mfa-azure-ad/</link>
      <pubDate>Thu, 20 Oct 2022 08:00:00 -0700</pubDate>
      <guid>https://embracethered.com/blog/posts/2022/ropci-so-you-think-you-have-mfa-azure-ad/</guid>
      <description>&lt;p&gt;This post will highlight a pattern I have seen across multiple production Microsoft Azure Active Directory tenants which led to MFA bypasses using ROPC.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;The key take-away: Always enforce MFA! Sounds easy, but there are often misconfigurations and unexpected exceptions. So, test your own AAD tenant for ROPC based MFA bypass opportunities.&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Github&lt;/strong&gt;: &lt;a href=&#34;https://github.com/wunderwuzzi23/ropci&#34;&gt;https://github.com/wunderwuzzi23/ropci&lt;/a&gt;&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Update&lt;/strong&gt;: The latest free issue of Pentest Magazine has a &lt;a href=&#34;https://pentestmag.com/product/pentest-open-source-pentesting-toolkit/&#34;&gt;ropci article&lt;/a&gt;. Check it out.&lt;/p&gt;&#xA;&lt;p&gt;&lt;img src=&#34;https://embracethered.com/blog/images/2022/ropci.png&#34; alt=&#34;How does an OAuth2 ROPC Request look like&#34;&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>Malicious Python Packages and Code Execution via pip download</title>
      <link>https://embracethered.com/blog/posts/2022/python-package-manager-install-and-download-vulnerability/</link>
      <pubDate>Fri, 09 Sep 2022 16:30:29 -0700</pubDate>
      <guid>https://embracethered.com/blog/posts/2022/python-package-manager-install-and-download-vulnerability/</guid>
      <description>&lt;p&gt;This week I learned about a design flaw with &lt;code&gt;pip download&lt;/code&gt;, which allows an adversary to run arbitrary code.&lt;/p&gt;&#xA;&lt;p&gt;I assumed that running &lt;code&gt;pip install&lt;/code&gt; means anything could happen, but &lt;code&gt;pip download&lt;/code&gt; seems a bit surprising.&lt;/p&gt;&#xA;&lt;p&gt;Both seem useful for red teaming though.&lt;/p&gt;&#xA;&lt;h2 id=&#34;background&#34;&gt;Background&lt;/h2&gt;&#xA;&lt;p&gt;This post from Yehuda Gelb named &lt;a href=&#34;https://medium.com/checkmarx-security/automatic-execution-of-code-upon-package-download-on-python-package-manager-cd6ed9e366a8&#34;&gt;Automatic Execution of Code Upon Package Download on Python Package Manager&lt;/a&gt; which the &lt;a href=&#34;https://twit.tv/shows/security-now/episodes/887?autostart=false&#34;&gt;Security Now! podcast&lt;/a&gt; pointed me towards.&lt;/p&gt;&#xA;&lt;p&gt;The post highlights that just running &lt;code&gt;pip download&lt;/code&gt; can compromise your computer.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Offensive BPF: Using bpftrace to sniff PAM logon passwords</title>
      <link>https://embracethered.com/blog/posts/2022/offensive-bpf-bpftrace-sniff-logon-pam-passwords/</link>
      <pubDate>Sun, 10 Jul 2022 20:00:13 -0700</pubDate>
      <guid>https://embracethered.com/blog/posts/2022/offensive-bpf-bpftrace-sniff-logon-pam-passwords/</guid>
      <description>&lt;p&gt;This post is part of a series about &lt;strong&gt;Offensive BPF&lt;/strong&gt;. Click the &lt;a href=&#34;https://embracethered.com/blog/tags/ebpf&#34;&gt;&amp;ldquo;ebpf&amp;rdquo;&lt;/a&gt; tag to see all related posts.&lt;/p&gt;&#xA;&lt;p&gt;&lt;img src=&#34;https://embracethered.com/blog/images/2021/offensive-bpf.png&#34; alt=&#34;Offensive BPF&#34;&gt;&lt;/p&gt;&#xA;&lt;p&gt;It has been a while that we posted something in the &lt;a href=&#34;https://embracethered.com/blog/tags/ebpf&#34;&gt;&amp;ldquo;Offensive BPF&amp;rdquo;&lt;/a&gt; series. But recently there have been a couple of new cool ebpf based tools, such as &lt;a href=&#34;https://github.com/h3xduck/TripleCross&#34;&gt;TripleCross&lt;/a&gt;, &lt;a href=&#34;https://github.com/kris-nova/boopkit&#34;&gt;boopkit&lt;/a&gt; and &lt;a href=&#34;https://github.com/citronneur/pamspy&#34;&gt;pamspy&lt;/a&gt;.&lt;/p&gt;&#xA;&lt;p&gt;So, I thought it be quite fitting to do another post in the Offensive BPF series to keep raising awareness.&lt;/p&gt;&#xA;&lt;h1 id=&#34;lets-sniff-pam-again---pamsnoopbt&#34;&gt;Let&amp;rsquo;s sniff PAM again - pamsnoop.bt&lt;/h1&gt;&#xA;&lt;p&gt;A few weeks back we discussed a &lt;a href=&#34;https://embracethered.com/blog/posts/2022/post-exploit-pam-ssh-password-grabbing/&#34;&gt;backdoor PAM module&lt;/a&gt; to grab &lt;code&gt;authtok&lt;/code&gt; tokens (e.g. SSH passwords) when someone logs on to a machine. In this post we will build an eBPF program using &lt;code&gt;bpftrace&lt;/code&gt; to do the same. Kudos for the idea using eBPF go to &lt;a href=&#34;https://github.com/citronneur/pamspy&#34;&gt;citronneur&lt;/a&gt;.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Post Exploitation: Sniffing Logon Passwords with PAM</title>
      <link>https://embracethered.com/blog/posts/2022/post-exploit-pam-ssh-password-grabbing/</link>
      <pubDate>Sun, 26 Jun 2022 22:50:18 -0800</pubDate>
      <guid>https://embracethered.com/blog/posts/2022/post-exploit-pam-ssh-password-grabbing/</guid>
      <description>&lt;p&gt;Pluggable Authentication Modules (PAM) on Unix based systems are useful to change logon behavior and enforce authentication via various means.&lt;/p&gt;&#xA;&lt;p&gt;In &amp;ldquo;Red Team Strategies&amp;rdquo; the chapter &amp;ldquo;Protecting the Pentester&amp;rdquo; walks the reader through the configuration of a PAM module to get notified in real-time via a pop-up when someone logs on to the machine (e.g. system compromise).&lt;/p&gt;&#xA;&lt;p&gt;But there are also &lt;strong&gt;bad things&lt;/strong&gt; that can be done with PAM (especially post-exploitation) and this is what this post is about.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Grabbing and cracking macOS hashes</title>
      <link>https://embracethered.com/blog/posts/2022/grabbing-and-cracking-macos-hashes/</link>
      <pubDate>Sun, 03 Apr 2022 10:46:07 -0700</pubDate>
      <guid>https://embracethered.com/blog/posts/2022/grabbing-and-cracking-macos-hashes/</guid>
      <description>&lt;p&gt;Information for red teaming macOS and info on real world TTPs are still a bit sparse. That makes it difficult for defenders to know what attackers do on macOS compared to Windows. Some organizations might have a bigger blind spot when it comes to macOS.&lt;/p&gt;&#xA;&lt;p&gt;This post describes how an adversary can grab hashes from a macOS machine, how to convert it to a hashcat friendly format and use hashcat to crack it.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Flipper Zero - Initial Thoughts</title>
      <link>https://embracethered.com/blog/posts/2022/flipper-zero-intro/</link>
      <pubDate>Fri, 18 Mar 2022 23:58:26 -0700</pubDate>
      <guid>https://embracethered.com/blog/posts/2022/flipper-zero-intro/</guid>
      <description>&lt;p&gt;After a bit of a delay my &lt;strong&gt;Flipper Zero&lt;/strong&gt; finally arrived in the mail. If you are not familiar with Flipper Zero at all, check out the &lt;a href=&#34;https://www.kickstarter.com/projects/flipper-devices/flipper-zero-tamagochi-for-hackers&#34;&gt;original Kickstarter page&lt;/a&gt; from a few years back.&lt;/p&gt;&#xA;&lt;p&gt;This is what the package looks like after opening. It contains the device, a USB cable, a quick start manual (mostly pointing you to the Flipper Zero website), and a Flipper &amp;ldquo;Hack the planet&amp;rdquo; sticker.&lt;/p&gt;&#xA;&lt;p&gt;&lt;img src=&#34;https://embracethered.com/blog/images/2022/flipper-package.png&#34; alt=&#34;Flipper Zero - Package&#34;&gt;&lt;/p&gt;</description>
    </item>
    <item>
      <title>Gitlab Reconnaissance Introduction</title>
      <link>https://embracethered.com/blog/posts/2022/hacking-gitlab-servers/</link>
      <pubDate>Mon, 28 Feb 2022 04:22:22 -0700</pubDate>
      <guid>https://embracethered.com/blog/posts/2022/hacking-gitlab-servers/</guid>
      <description>&lt;p&gt;Although Gitlab is not as popular as Github, itâ€™s common to run across it these days. Especially after Microsoft acquired Github it seemed more individuals and organizations flocked over to Gitlab.&lt;/p&gt;&#xA;&lt;p&gt;In this post I want to document a couple of recon commands that are useful post-exploitation, and for blue teamers to watch out for.&lt;/p&gt;&#xA;&lt;p&gt;Let&amp;rsquo;s assume one has access to a Gitlab Token as a precursor. Let&amp;rsquo;s walk through some interesting commands and script snippets to leverage to find out more.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Log4Shell and Request Forgery Attacks</title>
      <link>https://embracethered.com/blog/posts/2022/log4shell-and-request-forgery-attacks/</link>
      <pubDate>Tue, 04 Jan 2022 15:18:18 -0800</pubDate>
      <guid>https://embracethered.com/blog/posts/2022/log4shell-and-request-forgery-attacks/</guid>
      <description>&lt;p&gt;The last weeks of 2021 got quite interesting for security professionals and software engineers.&lt;/p&gt;&#xA;&lt;p&gt;Apache&amp;rsquo;s &lt;a href=&#34;https://logging.apache.org/log4j/2.x/&#34;&gt;log4j library&lt;/a&gt; and its now prominent &lt;a href=&#34;https://docs.oracle.com/javase/tutorial/jndi/overview/index.html&#34;&gt;Java Naming and Directory Interface support&lt;/a&gt;, which enables easy remote code execution, made the news across the industry.&lt;/p&gt;&#xA;&lt;p&gt;What makes Log4Shell scary is the widespread adoption of the Log4j library amongst Java applications, and the ease of remote exploitation.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;A dangerous combination.&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;Patches got released, bypasses were discovered more patches were released and so forth.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Offensive BPF: Understanding and using bpf_probe_write_user</title>
      <link>https://embracethered.com/blog/posts/2021/offensive-bpf-libbpf-bpf_probe_write_user/</link>
      <pubDate>Wed, 20 Oct 2021 00:04:40 -0700</pubDate>
      <guid>https://embracethered.com/blog/posts/2021/offensive-bpf-libbpf-bpf_probe_write_user/</guid>
      <description>&lt;p&gt;This post is part of a series about &lt;strong&gt;Offensive BPF&lt;/strong&gt; to learn how BPFs use will impact offensive security, malware, and detection engineering.&lt;/p&gt;&#xA;&lt;p&gt;Click the &lt;a href=&#34;https://embracethered.com/blog/tags/ebpf&#34;&gt;&amp;ldquo;ebpf&amp;rdquo;&lt;/a&gt; tag to see all relevant posts.&lt;/p&gt;&#xA;&lt;p&gt;&lt;img src=&#34;https://embracethered.com/blog/images/2021/offensive-bpf.png&#34; alt=&#34;Offensive BPF&#34;&gt;&lt;/p&gt;&#xA;&lt;h2 id=&#34;building-advanced-bpf-programs&#34;&gt;Building advanced BPF programs&lt;/h2&gt;&#xA;&lt;p&gt;So far in this Offensive BPF series the focus was on &lt;code&gt;bpftrace&lt;/code&gt; to build and run BPF programs.&lt;/p&gt;&#xA;&lt;p&gt;The next thing I wanted to investigate is what options are available to &lt;strong&gt;modify data structures during BPF execution&lt;/strong&gt;. This is where I hit limitations with &lt;code&gt;bpftrace&lt;/code&gt;.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Offensive BPF: Sniffing Firefox traffic with bpftrace</title>
      <link>https://embracethered.com/blog/posts/2021/offensive-bpf-sniffing-traffic-bpftrace/</link>
      <pubDate>Thu, 14 Oct 2021 00:10:16 -0700</pubDate>
      <guid>https://embracethered.com/blog/posts/2021/offensive-bpf-sniffing-traffic-bpftrace/</guid>
      <description>&lt;p&gt;This post is part of a series about &lt;strong&gt;Offensive BPF&lt;/strong&gt; that I&amp;rsquo;m working on to learn how BPFs use will impact offensive security, malware, and detection engineering.&lt;/p&gt;&#xA;&lt;p&gt;Click the &lt;a href=&#34;https://embracethered.com/blog/tags/ebpf&#34;&gt;&amp;ldquo;ebpf&amp;rdquo;&lt;/a&gt; tag to see all relevant posts.&lt;/p&gt;&#xA;&lt;p&gt;&lt;img src=&#34;https://embracethered.com/blog/images/2021/offensive-bpf.png&#34; alt=&#34;Offensive BPF&#34;&gt;&lt;/p&gt;&#xA;&lt;p&gt;One of the issues I ran into when trying out &lt;code&gt;sslsniff-bpfcc&lt;/code&gt; was that it did not work with Firefox or Chrome traffic.&lt;/p&gt;&#xA;&lt;p&gt;This post is about me learning how to hook user space APIs with &lt;code&gt;bpftrace&lt;/code&gt; using uprobes.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Offensive BPF: What&#39;s in the bpfcc-tools box?</title>
      <link>https://embracethered.com/blog/posts/2021/offensive-bpf-handy-tools/</link>
      <pubDate>Sat, 09 Oct 2021 14:00:59 -0700</pubDate>
      <guid>https://embracethered.com/blog/posts/2021/offensive-bpf-handy-tools/</guid>
      <description>&lt;p&gt;This post is part of a series about &lt;strong&gt;Offensive BPF&lt;/strong&gt; that I&amp;rsquo;m working on to learn about BPF to understand attacks and defenses. Click the &lt;a href=&#34;https://embracethered.com/blog/tags/ebpf&#34;&gt;&amp;ldquo;ebpf&amp;rdquo;&lt;/a&gt; tag to see all relevant posts.&lt;/p&gt;&#xA;&lt;p&gt;&lt;img src=&#34;https://embracethered.com/blog/images/2021/offensive-bpf.png&#34; alt=&#34;Offensive BPF&#34;&gt;&lt;/p&gt;&#xA;&lt;p&gt;In the previous posts I spend time learning about &lt;code&gt;bpftrace&lt;/code&gt; which is quite powerful. This post is focused on basics and using existing BPF tools, rather then building new BPF programs from scratch.&lt;/p&gt;&#xA;&lt;h1 id=&#34;living-off-the-land-bpfcc-tools&#34;&gt;Living off the land: bpfcc-tools&lt;/h1&gt;&#xA;&lt;p&gt;Performance and observability teams are pushing for BPF tooling to be present in production. Due to its usefulness, this is likely going to increase.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Offensive BPF: Detection Ideas</title>
      <link>https://embracethered.com/blog/posts/2021/offensive-bpf-detections-initial-ideas/</link>
      <pubDate>Thu, 07 Oct 2021 08:00:00 -0700</pubDate>
      <guid>https://embracethered.com/blog/posts/2021/offensive-bpf-detections-initial-ideas/</guid>
      <description>&lt;p&gt;This post is part of a series about &lt;strong&gt;Offensive BPF&lt;/strong&gt; that I&amp;rsquo;m working on to learn how BPFs use will impact offensive security, malware and detection engineering.&lt;/p&gt;&#xA;&lt;p&gt;Click the &lt;a href=&#34;https://embracethered.com/blog/tags/ebpf&#34;&gt;&amp;ldquo;ebpf&amp;rdquo;&lt;/a&gt; tag to see all relevant posts.&lt;/p&gt;&#xA;&lt;p&gt;&lt;img src=&#34;https://embracethered.com/blog/images/2021/offensive-bpf.png&#34; alt=&#34;Offensive BPF&#34;&gt;&lt;/p&gt;&#xA;&lt;p&gt;In the last few posts, we talked about a &lt;code&gt;bpftrace&lt;/code&gt; and how attackers can use it to their advantage. This post is about my initial ideas and strategies to detecting malicious usage.&lt;/p&gt;&#xA;&lt;h2 id=&#34;detecting-bpf-misuse&#34;&gt;Detecting BPF misuse&lt;/h2&gt;&#xA;&lt;p&gt;There are a set of detection ideas for Blue Teams. Since we primarily talked about &lt;code&gt;bpftrace&lt;/code&gt; so far, let&amp;rsquo;s explore that angle.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Offensive BPF: Using bpftrace to host backdoors</title>
      <link>https://embracethered.com/blog/posts/2021/offensive-bpf-bpftrace-message-based/</link>
      <pubDate>Wed, 06 Oct 2021 20:00:13 -0700</pubDate>
      <guid>https://embracethered.com/blog/posts/2021/offensive-bpf-bpftrace-message-based/</guid>
      <description>&lt;p&gt;This post is part of a series about &lt;strong&gt;Offensive BPF&lt;/strong&gt; that I&amp;rsquo;m working on to learn how BPFs use will impact offensive security, malware and detection engineering. Click the &lt;a href=&#34;https://embracethered.com/blog/tags/ebpf&#34;&gt;&amp;ldquo;ebpf&amp;rdquo;&lt;/a&gt; tag to see all relevant posts.&lt;/p&gt;&#xA;&lt;p&gt;&lt;img src=&#34;https://embracethered.com/blog/images/2021/offensive-bpf.png&#34; alt=&#34;Offensive BPF&#34;&gt;&lt;/p&gt;&#xA;&lt;p&gt;In the last post we talked about a basic bpftrace script to install a BPF program that runs commands upon connecting from a specific IP with a specific magic source port.&lt;/p&gt;&#xA;&lt;p&gt;This post will dive into this idea more by leveraging more a complex solution.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Offensive BPF: Malicious bpftrace ðŸ¤¯</title>
      <link>https://embracethered.com/blog/posts/2021/offensive-bpf-bpftrace/</link>
      <pubDate>Tue, 05 Oct 2021 08:00:58 -0700</pubDate>
      <guid>https://embracethered.com/blog/posts/2021/offensive-bpf-bpftrace/</guid>
      <description>&lt;p&gt;This post is part of a series about &lt;strong&gt;Offensive BPF&lt;/strong&gt; that I&amp;rsquo;m working on to learn about BPF to understand attacks and defenses, click the &lt;a href=&#34;https://embracethered.com/blog/tags/ebpf&#34;&gt;&amp;ldquo;ebpf&amp;rdquo;&lt;/a&gt; tag to see all relevant posts.&lt;/p&gt;&#xA;&lt;p&gt;I&amp;rsquo;m learning BPF to understand how its use will impact offensive security, malware, and detection engineering.&lt;/p&gt;&#xA;&lt;p&gt;&lt;img src=&#34;https://embracethered.com/blog/images/2021/offensive-bpf.png&#34; alt=&#34;Offensive BPF&#34;&gt;&lt;/p&gt;&#xA;&lt;p&gt;One offsec idea that quickly comes to mind with BPF is to observe network traffic and act upon specific events. So, I wanted to see if/how &lt;code&gt;bpftrace&lt;/code&gt;, a popular tool for running BPF programs, can be used to create potential backdoors, and what evidence to look for as defenders.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Offensive BPF! Getting started.</title>
      <link>https://embracethered.com/blog/posts/2021/offensive-bpf/</link>
      <pubDate>Thu, 30 Sep 2021 00:00:00 -0700</pubDate>
      <guid>https://embracethered.com/blog/posts/2021/offensive-bpf/</guid>
      <description>&lt;p&gt;Over the last few years eBPF has gained a lot of traction in the Linux community and beyond.&lt;/p&gt;&#xA;&lt;p&gt;eBPF&amp;rsquo;s offensive usage is also slowly getting more attention. So, I decided to dive into the topic from a red teaming point of view to learn about it to raise awareness and share the journey.&lt;/p&gt;&#xA;&lt;p&gt;&lt;img src=&#34;https://embracethered.com/blog/images/2021/offensive-bpf.png&#34; alt=&#34;Offensive BPF&#34;&gt;&lt;/p&gt;&#xA;&lt;p&gt;Similar to the format of my &lt;a href=&#34;https://embracethered.com/blog/posts/2020/machine-learning-attack-series-overview/&#34;&gt;Machine Learning Attack Series&lt;/a&gt;, there will be a serious of posts around BPF usage in offensive settings, and also how its misuse can be detected.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Abusing Application Layer Gateways (NAT Slipstreaming)</title>
      <link>https://embracethered.com/blog/posts/2020/nat-slipstreaming-simplified/</link>
      <pubDate>Mon, 23 Nov 2020 23:00:57 -0800</pubDate>
      <guid>https://embracethered.com/blog/posts/2020/nat-slipstreaming-simplified/</guid>
      <description>&lt;p&gt;You might have heard about &lt;a href=&#34;https://samy.pl/slipstream/&#34;&gt;&amp;ldquo;NAT Slipstreaming&amp;rdquo;&lt;/a&gt; by Samy Kamkar. It&amp;rsquo;s an amazing technique that allows punching a hole in your routers firewall by just visiting a website.&lt;/p&gt;&#xA;&lt;p&gt;The attack depends on the router having the &lt;code&gt;Application Layer Gateway&lt;/code&gt; enabled. This gateway can be used by anyone inside your network to open a firewall port (totally by design). Protocols such as &lt;code&gt;SIP&lt;/code&gt; (&lt;code&gt;Session Initiation Protocol&lt;/code&gt;) use it.&lt;/p&gt;&#xA;&lt;p&gt;What I will focus on in this post is the &lt;code&gt;Application Layer Gateway&lt;/code&gt; (&lt;code&gt;ALG&lt;/code&gt;) and &lt;code&gt;SIP&lt;/code&gt;. In particular to understand how these can be abused by an adversary.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Race conditions when applying ACLs</title>
      <link>https://embracethered.com/blog/posts/2020/applying-acls-and-race-conditions/</link>
      <pubDate>Mon, 24 Aug 2020 12:00:33 -0800</pubDate>
      <guid>https://embracethered.com/blog/posts/2020/applying-acls-and-race-conditions/</guid>
      <description>&lt;p&gt;Today I&amp;rsquo;m gonna talk about a class of application security issues I ran across a few times over the years. In particular, let&amp;rsquo;s discuss race conditions when it comes to files with sensitive content and permissions.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;Race conditions&lt;/strong&gt; can allow an adversary to gain access to sensitive information on machines. Assume a system creates a file that contains sensitive information and &lt;em&gt;afterwards&lt;/em&gt; applies permissions to lockdown that file.&lt;/p&gt;&#xA;&lt;h2 id=&#34;understanding-the-race-condition&#34;&gt;Understanding the race condition&lt;/h2&gt;&#xA;&lt;p&gt;Let&amp;rsquo;s look at a practical example seen in the wild a few times. Imagine code like this:&lt;/p&gt;</description>
    </item>
    <item>
      <title>2600 - The Hacker Quarterly - Pass the Cookie Article</title>
      <link>https://embracethered.com/blog/posts/2020/2600-hacker-pass-the-cookie/</link>
      <pubDate>Sat, 15 Feb 2020 15:48:51 -0800</pubDate>
      <guid>https://embracethered.com/blog/posts/2020/2600-hacker-pass-the-cookie/</guid>
      <description>&lt;p&gt;Pass the Cookie made it into the latest 2600 magazine! Very excited about this!&lt;/p&gt;&#xA;&lt;p&gt;I was just walking around Capitol Hill and stopped by &lt;a href=&#34;https://www.adasbooks.com/&#34;&gt;Ada&amp;rsquo;s Technical Books&lt;/a&gt; on 15th Avenue - a great coffee shop with lots of technical books. Right after walking in to grab a cup of tea, I saw the latest Hacker Quarterly. A few months back I submitted an article about &amp;ldquo;Pass the Cookie&amp;rdquo;, so I had to check, and the article got indeed published!&lt;/p&gt;</description>
    </item>
    <item>
      <title>Active Directory and MacOS</title>
      <link>https://embracethered.com/blog/posts/active-directory-and-macos/</link>
      <pubDate>Thu, 20 Jun 2019 22:00:16 -0700</pubDate>
      <guid>https://embracethered.com/blog/posts/active-directory-and-macos/</guid>
      <description>&lt;h2 id=&#34;interacting-with-active-directory-on-the-mac&#34;&gt;Interacting with Active Directory on the Mac&lt;/h2&gt;&#xA;&lt;p&gt;Did you ever have to interact with Active Directory on a MAC?&lt;/p&gt;&#xA;&lt;p&gt;If yes, this post might be interesting for you. I am pretty new to the Mac and basic things I know how to do on Windows need some research to figure out. This time around I explore Active Directory/LDAP Server interactions.&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;First, there is the &lt;em&gt;Directory Utility&lt;/em&gt; on MacOS which can be quite useful.&lt;/li&gt;&#xA;&lt;li&gt;Second, there is Apache&amp;rsquo;s - &lt;em&gt;Directory Studio&lt;/em&gt; - which is pretty amazing and feature rich.&lt;/li&gt;&#xA;&lt;li&gt;Third, you might want to write your own tools or scripts.&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;There are ldap commands that allow you to do most tasks in automated fashion.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Google Leaks Your Alternate Email Addresses to Unauthenticated Users</title>
      <link>https://embracethered.com/blog/posts/google-email-leak/</link>
      <pubDate>Tue, 04 Jun 2019 21:51:52 -0700</pubDate>
      <guid>https://embracethered.com/blog/posts/google-email-leak/</guid>
      <description>&lt;p&gt;The Google Login Flow leaks additional email account information to unauthenticated users. I discovered this in the Google Account Login flow while building KoiPhish.&lt;/p&gt;&#xA;&lt;h2 id=&#34;responsible-disclosure&#34;&gt;Responsible Disclosure&lt;/h2&gt;&#xA;&lt;p&gt;I reported this issue to Google and they looked into it and after a about 5 weeks of back and forth they decided that this is not an issue worth fixing. After asking if I can post about it publicly I got Google&amp;rsquo;s okay.&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
