<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Ebpf on Embrace The Red</title>
    <link>http://localhost:1313/blog/tags/ebpf/</link>
    <description>Recent content in Ebpf on Embrace The Red</description>
    <generator>Hugo</generator>
    <language>en-us</language>
    <copyright>(c) WUNDERWUZZI 2018-2026</copyright>
    <lastBuildDate>Sun, 10 Jul 2022 20:00:13 -0700</lastBuildDate>
    <atom:link href="http://localhost:1313/blog/tags/ebpf/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Offensive BPF: Using bpftrace to sniff PAM logon passwords</title>
      <link>http://localhost:1313/blog/posts/2022/offensive-bpf-bpftrace-sniff-logon-pam-passwords/</link>
      <pubDate>Sun, 10 Jul 2022 20:00:13 -0700</pubDate>
      <guid>http://localhost:1313/blog/posts/2022/offensive-bpf-bpftrace-sniff-logon-pam-passwords/</guid>
      <description>&lt;p&gt;This post is part of a series about &lt;strong&gt;Offensive BPF&lt;/strong&gt;. Click the &lt;a href=&#34;http://localhost:1313/blog/tags/ebpf&#34;&gt;&amp;ldquo;ebpf&amp;rdquo;&lt;/a&gt; tag to see all related posts.&lt;/p&gt;&#xA;&lt;p&gt;&lt;img src=&#34;http://localhost:1313/blog/images/2021/offensive-bpf.png&#34; alt=&#34;Offensive BPF&#34;&gt;&lt;/p&gt;&#xA;&lt;p&gt;It has been a while that we posted something in the &lt;a href=&#34;http://localhost:1313/blog/tags/ebpf&#34;&gt;&amp;ldquo;Offensive BPF&amp;rdquo;&lt;/a&gt; series. But recently there have been a couple of new cool ebpf based tools, such as &lt;a href=&#34;https://github.com/h3xduck/TripleCross&#34;&gt;TripleCross&lt;/a&gt;, &lt;a href=&#34;https://github.com/kris-nova/boopkit&#34;&gt;boopkit&lt;/a&gt; and &lt;a href=&#34;https://github.com/citronneur/pamspy&#34;&gt;pamspy&lt;/a&gt;.&lt;/p&gt;&#xA;&lt;p&gt;So, I thought it be quite fitting to do another post in the Offensive BPF series to keep raising awareness.&lt;/p&gt;&#xA;&lt;h1 id=&#34;lets-sniff-pam-again---pamsnoopbt&#34;&gt;Let&amp;rsquo;s sniff PAM again - pamsnoop.bt&lt;/h1&gt;&#xA;&lt;p&gt;A few weeks back we discussed a &lt;a href=&#34;http://localhost:1313/blog/posts/2022/post-exploit-pam-ssh-password-grabbing/&#34;&gt;backdoor PAM module&lt;/a&gt; to grab &lt;code&gt;authtok&lt;/code&gt; tokens (e.g. SSH passwords) when someone logs on to a machine. In this post we will build an eBPF program using &lt;code&gt;bpftrace&lt;/code&gt; to do the same. Kudos for the idea using eBPF go to &lt;a href=&#34;https://github.com/citronneur/pamspy&#34;&gt;citronneur&lt;/a&gt;.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Offensive BPF: Understanding and using bpf_probe_write_user</title>
      <link>http://localhost:1313/blog/posts/2021/offensive-bpf-libbpf-bpf_probe_write_user/</link>
      <pubDate>Wed, 20 Oct 2021 00:04:40 -0700</pubDate>
      <guid>http://localhost:1313/blog/posts/2021/offensive-bpf-libbpf-bpf_probe_write_user/</guid>
      <description>&lt;p&gt;This post is part of a series about &lt;strong&gt;Offensive BPF&lt;/strong&gt; to learn how BPFs use will impact offensive security, malware, and detection engineering.&lt;/p&gt;&#xA;&lt;p&gt;Click the &lt;a href=&#34;http://localhost:1313/blog/tags/ebpf&#34;&gt;&amp;ldquo;ebpf&amp;rdquo;&lt;/a&gt; tag to see all relevant posts.&lt;/p&gt;&#xA;&lt;p&gt;&lt;img src=&#34;http://localhost:1313/blog/images/2021/offensive-bpf.png&#34; alt=&#34;Offensive BPF&#34;&gt;&lt;/p&gt;&#xA;&lt;h2 id=&#34;building-advanced-bpf-programs&#34;&gt;Building advanced BPF programs&lt;/h2&gt;&#xA;&lt;p&gt;So far in this Offensive BPF series the focus was on &lt;code&gt;bpftrace&lt;/code&gt; to build and run BPF programs.&lt;/p&gt;&#xA;&lt;p&gt;The next thing I wanted to investigate is what options are available to &lt;strong&gt;modify data structures during BPF execution&lt;/strong&gt;. This is where I hit limitations with &lt;code&gt;bpftrace&lt;/code&gt;.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Offensive BPF: Sniffing Firefox traffic with bpftrace</title>
      <link>http://localhost:1313/blog/posts/2021/offensive-bpf-sniffing-traffic-bpftrace/</link>
      <pubDate>Thu, 14 Oct 2021 00:10:16 -0700</pubDate>
      <guid>http://localhost:1313/blog/posts/2021/offensive-bpf-sniffing-traffic-bpftrace/</guid>
      <description>&lt;p&gt;This post is part of a series about &lt;strong&gt;Offensive BPF&lt;/strong&gt; that I&amp;rsquo;m working on to learn how BPFs use will impact offensive security, malware, and detection engineering.&lt;/p&gt;&#xA;&lt;p&gt;Click the &lt;a href=&#34;http://localhost:1313/blog/tags/ebpf&#34;&gt;&amp;ldquo;ebpf&amp;rdquo;&lt;/a&gt; tag to see all relevant posts.&lt;/p&gt;&#xA;&lt;p&gt;&lt;img src=&#34;http://localhost:1313/blog/images/2021/offensive-bpf.png&#34; alt=&#34;Offensive BPF&#34;&gt;&lt;/p&gt;&#xA;&lt;p&gt;One of the issues I ran into when trying out &lt;code&gt;sslsniff-bpfcc&lt;/code&gt; was that it did not work with Firefox or Chrome traffic.&lt;/p&gt;&#xA;&lt;p&gt;This post is about me learning how to hook user space APIs with &lt;code&gt;bpftrace&lt;/code&gt; using uprobes.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Offensive BPF: What&#39;s in the bpfcc-tools box?</title>
      <link>http://localhost:1313/blog/posts/2021/offensive-bpf-handy-tools/</link>
      <pubDate>Sat, 09 Oct 2021 14:00:59 -0700</pubDate>
      <guid>http://localhost:1313/blog/posts/2021/offensive-bpf-handy-tools/</guid>
      <description>&lt;p&gt;This post is part of a series about &lt;strong&gt;Offensive BPF&lt;/strong&gt; that I&amp;rsquo;m working on to learn about BPF to understand attacks and defenses. Click the &lt;a href=&#34;http://localhost:1313/blog/tags/ebpf&#34;&gt;&amp;ldquo;ebpf&amp;rdquo;&lt;/a&gt; tag to see all relevant posts.&lt;/p&gt;&#xA;&lt;p&gt;&lt;img src=&#34;http://localhost:1313/blog/images/2021/offensive-bpf.png&#34; alt=&#34;Offensive BPF&#34;&gt;&lt;/p&gt;&#xA;&lt;p&gt;In the previous posts I spend time learning about &lt;code&gt;bpftrace&lt;/code&gt; which is quite powerful. This post is focused on basics and using existing BPF tools, rather then building new BPF programs from scratch.&lt;/p&gt;&#xA;&lt;h1 id=&#34;living-off-the-land-bpfcc-tools&#34;&gt;Living off the land: bpfcc-tools&lt;/h1&gt;&#xA;&lt;p&gt;Performance and observability teams are pushing for BPF tooling to be present in production. Due to its usefulness, this is likely going to increase.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Offensive BPF: Detection Ideas</title>
      <link>http://localhost:1313/blog/posts/2021/offensive-bpf-detections-initial-ideas/</link>
      <pubDate>Thu, 07 Oct 2021 08:00:00 -0700</pubDate>
      <guid>http://localhost:1313/blog/posts/2021/offensive-bpf-detections-initial-ideas/</guid>
      <description>&lt;p&gt;This post is part of a series about &lt;strong&gt;Offensive BPF&lt;/strong&gt; that I&amp;rsquo;m working on to learn how BPFs use will impact offensive security, malware and detection engineering.&lt;/p&gt;&#xA;&lt;p&gt;Click the &lt;a href=&#34;http://localhost:1313/blog/tags/ebpf&#34;&gt;&amp;ldquo;ebpf&amp;rdquo;&lt;/a&gt; tag to see all relevant posts.&lt;/p&gt;&#xA;&lt;p&gt;&lt;img src=&#34;http://localhost:1313/blog/images/2021/offensive-bpf.png&#34; alt=&#34;Offensive BPF&#34;&gt;&lt;/p&gt;&#xA;&lt;p&gt;In the last few posts, we talked about a &lt;code&gt;bpftrace&lt;/code&gt; and how attackers can use it to their advantage. This post is about my initial ideas and strategies to detecting malicious usage.&lt;/p&gt;&#xA;&lt;h2 id=&#34;detecting-bpf-misuse&#34;&gt;Detecting BPF misuse&lt;/h2&gt;&#xA;&lt;p&gt;There are a set of detection ideas for Blue Teams. Since we primarily talked about &lt;code&gt;bpftrace&lt;/code&gt; so far, let&amp;rsquo;s explore that angle.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Offensive BPF: Using bpftrace to host backdoors</title>
      <link>http://localhost:1313/blog/posts/2021/offensive-bpf-bpftrace-message-based/</link>
      <pubDate>Wed, 06 Oct 2021 20:00:13 -0700</pubDate>
      <guid>http://localhost:1313/blog/posts/2021/offensive-bpf-bpftrace-message-based/</guid>
      <description>&lt;p&gt;This post is part of a series about &lt;strong&gt;Offensive BPF&lt;/strong&gt; that I&amp;rsquo;m working on to learn how BPFs use will impact offensive security, malware and detection engineering. Click the &lt;a href=&#34;http://localhost:1313/blog/tags/ebpf&#34;&gt;&amp;ldquo;ebpf&amp;rdquo;&lt;/a&gt; tag to see all relevant posts.&lt;/p&gt;&#xA;&lt;p&gt;&lt;img src=&#34;http://localhost:1313/blog/images/2021/offensive-bpf.png&#34; alt=&#34;Offensive BPF&#34;&gt;&lt;/p&gt;&#xA;&lt;p&gt;In the last post we talked about a basic bpftrace script to install a BPF program that runs commands upon connecting from a specific IP with a specific magic source port.&lt;/p&gt;&#xA;&lt;p&gt;This post will dive into this idea more by leveraging more a complex solution.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Offensive BPF: Malicious bpftrace ðŸ¤¯</title>
      <link>http://localhost:1313/blog/posts/2021/offensive-bpf-bpftrace/</link>
      <pubDate>Tue, 05 Oct 2021 08:00:58 -0700</pubDate>
      <guid>http://localhost:1313/blog/posts/2021/offensive-bpf-bpftrace/</guid>
      <description>&lt;p&gt;This post is part of a series about &lt;strong&gt;Offensive BPF&lt;/strong&gt; that I&amp;rsquo;m working on to learn about BPF to understand attacks and defenses, click the &lt;a href=&#34;http://localhost:1313/blog/tags/ebpf&#34;&gt;&amp;ldquo;ebpf&amp;rdquo;&lt;/a&gt; tag to see all relevant posts.&lt;/p&gt;&#xA;&lt;p&gt;I&amp;rsquo;m learning BPF to understand how its use will impact offensive security, malware, and detection engineering.&lt;/p&gt;&#xA;&lt;p&gt;&lt;img src=&#34;http://localhost:1313/blog/images/2021/offensive-bpf.png&#34; alt=&#34;Offensive BPF&#34;&gt;&lt;/p&gt;&#xA;&lt;p&gt;One offsec idea that quickly comes to mind with BPF is to observe network traffic and act upon specific events. So, I wanted to see if/how &lt;code&gt;bpftrace&lt;/code&gt;, a popular tool for running BPF programs, can be used to create potential backdoors, and what evidence to look for as defenders.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Offensive BPF! Getting started.</title>
      <link>http://localhost:1313/blog/posts/2021/offensive-bpf/</link>
      <pubDate>Thu, 30 Sep 2021 00:00:00 -0700</pubDate>
      <guid>http://localhost:1313/blog/posts/2021/offensive-bpf/</guid>
      <description>&lt;p&gt;Over the last few years eBPF has gained a lot of traction in the Linux community and beyond.&lt;/p&gt;&#xA;&lt;p&gt;eBPF&amp;rsquo;s offensive usage is also slowly getting more attention. So, I decided to dive into the topic from a red teaming point of view to learn about it to raise awareness and share the journey.&lt;/p&gt;&#xA;&lt;p&gt;&lt;img src=&#34;http://localhost:1313/blog/images/2021/offensive-bpf.png&#34; alt=&#34;Offensive BPF&#34;&gt;&lt;/p&gt;&#xA;&lt;p&gt;Similar to the format of my &lt;a href=&#34;http://localhost:1313/blog/posts/2020/machine-learning-attack-series-overview/&#34;&gt;Machine Learning Attack Series&lt;/a&gt;, there will be a serious of posts around BPF usage in offensive settings, and also how its misuse can be detected.&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
