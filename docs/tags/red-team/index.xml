<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Red Team on Embrace The Red</title>
    <link>https://embracethered.com/blog/tags/red-team/</link>
    <description>Recent content in Red Team on Embrace The Red</description>
    <generator>Hugo</generator>
    <language>en-us</language>
    <copyright>(c) WUNDERWUZZI 2018-2026</copyright>
    <lastBuildDate>Wed, 04 Jan 2023 06:36:05 -0800</lastBuildDate>
    <atom:link href="https://embracethered.com/blog/tags/red-team/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Decrypting TLS browser traffic with Wireshark</title>
      <link>https://embracethered.com/blog/posts/2023/decrypt-wireshark-traffic-https-netsh/</link>
      <pubDate>Wed, 04 Jan 2023 06:36:05 -0800</pubDate>
      <guid>https://embracethered.com/blog/posts/2023/decrypt-wireshark-traffic-https-netsh/</guid>
      <description>&lt;p&gt;There is a combination of lesser known tools and techniques to capture and later decrypt SSL/TLS network traffic on Windows. This technique is neat because it does not require the installation of additional driver/software when capturing the traffic.&lt;/p&gt;&#xA;&lt;h2 id=&#34;technique-tools-and-steps&#34;&gt;Technique, Tools and Steps&lt;/h2&gt;&#xA;&lt;p&gt;It is quite straight forward and consists of:&lt;/p&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;Setting the &lt;code&gt;SSLKEYLOGFILE&lt;/code&gt; environment variable to capture TLS session keys on target host&lt;/li&gt;&#xA;&lt;li&gt;Use &lt;code&gt;netsh trace start&lt;/code&gt; to capture traffic (no need to install additional driver/software!)&lt;/li&gt;&#xA;&lt;li&gt;Convert the &lt;code&gt;.etl&lt;/code&gt; file to a &lt;code&gt;pcap&lt;/code&gt; using Microsoft&amp;rsquo;s &lt;a href=&#34;https://github.com/microsoft/etl2pcapng&#34;&gt;etl2pcapng&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;Start &lt;code&gt;Wireshark&lt;/code&gt;, open the pcap and set the sslkeys under: &lt;em&gt;Preferences-&amp;gt;Protocols-&amp;gt;TLS-&amp;gt;Pre-Master secret&lt;/em&gt;.&#xA;This does not have to be on the same host as steps 1-2.&lt;/li&gt;&#xA;&lt;li&gt;Enjoy the decrypted traffic!&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;p&gt;If you can or want to capture traffic with Wireshark also, there is no need to use &lt;code&gt;netsh&lt;/code&gt; of course.&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
