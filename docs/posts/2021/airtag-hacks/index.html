<!DOCTYPE html>
<html lang="en-us">
<head prefix="og: http://ogp.me/ns#">
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1" />
  <meta property="og:title" content=" Airtag hacks - scanning via browser, removing speaker and data exfiltration &middot;  Embrace The Red" />
  
  <meta property="og:site_name" content="Embrace The Red" />
  <meta property="og:url" content="https://embracethered.com/blog/posts/2021/airtag-hacks/" />
  
  
  <meta property="og:type" content="article" />
  
  <meta property="og:article:published_time" content="2021-06-28T08:00:52-07:00" />
  
  <meta property="og:article:tag" content="red" />
  
  <meta property="og:article:tag" content="hardware" />
  
  

  <title>
     Airtag hacks - scanning via browser, removing speaker and data exfiltration &middot;  Embrace The Red
  </title>

  <link rel="stylesheet" href="https://embracethered.com/blog/css/bootstrap.min.css" />
  <link rel="stylesheet" href="https://embracethered.com/blog/css/main.css" />
  <link rel="stylesheet" href="https://embracethered.com/blog/css/font-awesome.min.css" />
  <link rel="stylesheet" href="https://embracethered.com/blog/css/github.css" />
  
  <link rel="stylesheet" href="https://embracethered.com/blog/fonts/cachedfonts.css" type="text/css">
  <link rel="shortcut icon" type="image/x-icon" href="https://embracethered.com/blog/images/favicon.ico" />
  <link rel="apple-touch-icon" type="image/x-icon" href="https://embracethered.com/blog/images/favicon.ico" />
  

  

  
</head>
<body>
    <header class="global-header"  style="background-image:url( /blog/images/bg.png )">
    <section class="header-text">
      <h1><a href="https://embracethered.com/blog/">Embrace The Red</a></h1>
      
      <div class="tag-line" style="min-width:fit-content; font-weight: 400;">
        wunderwuzzi&#39;s blog
        <br><a style="color: greenyellow; font-weight:300;text-decoration: underline; " href="https://www.amazon.com/gp/product/1838828869/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1838828869&linkCode=as2&tag=wunderwuzzi-20&linkId=b6523e937607be47499c6010ff489537">OUT NOW: Cybersecurity Attacks - Red Team Strategies</a> 
      </div>
      
      <div class="sns-links hidden-print">
  
  <a href="mailto:security@wunderwuzzi.net">
    <i class="fa fa-envelope"></i>
  </a>
  
  
  <a href="https://twitter.com/wunderwuzzi23" target="_blank">
    <i class="fa fa-twitter"></i>
  </a>
  
  
  
  
  
  <a href="https://github.com/wunderwuzzi23" target="_blank">
    <i class="fa fa-github"></i>
  </a>
  
  
  
  
  
  <a href="https://youtube.com/@embracethered" target="_blank">
    <i class="fa fa-youtube"></i>
  </a>
  
  
  
  <a href="/blog/index.xml" target="_blank">
    <i class="fa fa-rss"></i>
  </a>
</div>

      
      <a href="https://embracethered.com/blog/" class="btn-header btn-back hidden-xs">
        <i class="fa fa-angle-left" aria-hidden="true"></i>
        &nbsp;Home
      </a>
      
    
      <a href="/blog/index.xml" class="btn-header btn-subscribe hidden-xs">
        <i class="fa fa-rss" aria-hidden="true"></i>
        &nbsp;Subscribe
      </a>
    </section>
  </header>
  <main class="container">


<article>
  <header>
    <h1 class="text-primary">Airtag hacks - scanning via browser, removing speaker and data exfiltration</h1>
    <div class="post-meta clearfix">
    
      <div class="post-date pull-left">
        Posted on
        <time datetime="2021-06-28T08:00:52-07:00">
          Jun 28, 2021
        </time>
      </div>
    
      <div class="pull-right">
        
        <span class="post-tag small"><a href="https://embracethered.com/blog//tags/red">#red</a></span>
        
        <span class="post-tag small"><a href="https://embracethered.com/blog//tags/hardware">#hardware</a></span>
        
      </div>
    </div>
  </header>
  <section>
    <p>Until the Apple Airtag came out a few months ago I hadn&rsquo;t really looked into the tag tracking market. Turns out there were already quite a lot of offerings available before Apple joined the market, most notably <em>Tile</em>.</p>
<p>However, I wanted to try out the Airtag and ended up ordering a few.</p>
<p>This post will explore three things:</p>
<ol>
<li><a href="#removing-the-speaker">Removing the speaker of my Airtag</a></li>
<li><a href="#browsers-to-the-rescue">Using Browser APIs to scan for Airtags</a> (if you don&rsquo;t have an iPhone but someone tries to stalk you this might be handy)</li>
<li><a href="#novel-data-exfiltration">Explore data exfiltration via Airtags and Apple&rsquo;s &ldquo;Find My&rdquo; network</a></li>
</ol>
<p>By the way, when you order your Airtags online you can customize them. So, I have some cool icons on mine, like this one:</p>
<p><img src="/blog/images/2021/airtag.png" alt="Airtag"></p>
<p>The Airtags have a speaker built in which goes off when they are away from the owner, but following another device for an extended period of time. The time period was actually changed recently from 3 days to I think 8 hours, after privacy concerned articles and blog posts appeared.</p>
<p>Most importantly, a sound will be emitted once the Airtag appears to be following someone.</p>
<h2 id="removing-the-speaker">Removing the speaker</h2>
<p>A very obvious hack of course is to remove the speaker, which I was able to do in about 30 seconds using a sharp knife. Please note that this might destroy your Airtag - so know what you do.</p>
<p>This is how the microphone looks like (on the right, next to the main Airtag):</p>
<p><img src="/blog/images/2021/airtag-remove-mic.png" alt="Airtag Mic Remove"></p>
<p>Afterwards no sounds are emitted from the device anymore.</p>
<p>Technically, iPhone users should still be in a good shape as the &ldquo;Find My Device&rdquo; app should signal a warning via the app once a stalker Airtag is detected - which might take a few hours.</p>
<p><img src="/blog/images/2021/airtag-with-removed-mic.png" alt="Airtag Mic Removed"></p>
<p>For Android users the story is different though.</p>
<h2 id="waiting-for-an-apple-android-app">Waiting for an Apple Android App&hellip;</h2>
<p>Apple has not yet released an Android app - so stalkers can happily go after Android users with little risk of being detected.</p>
<p>The good news is that there are a set of Android apps that show you Bluetooth devices - which is one way to identify Airtags as well that might be in your proximity.</p>
<p><a href="https://arxiv.org/pdf/2103.02282.pdf">Recent research by the TU Darmstadt</a> contains a lot of useful information regarding the protocol and usage.</p>
<p><img src="/blog/images/2021/ble-ad.PNG" alt="Bluetooth Whitepaper Research"></p>
<p>Using information from the paper I checked to see if it&rsquo;s possible to implement a simple Airtag scanner for the browser.</p>
<h2 id="browsers-to-the-rescue">Browsers to the rescue</h2>
<p>Turns out that we can also use the browser to scan for Bluetooth device advertisements. In particular Chrome 92+ (<a href="https://chromereleases.googleblog.com/2021/06/chrome-beta-for-android-update_0893144828.html">currently in beta for Android users</a>) supports <code>requestDevice</code> and filtering via a <code>dataPrefix</code>.</p>
<p>The code I stitched together looks like this:</p>
<pre tabindex="0"><code> navigator.bluetooth.requestDevice({
      filters: [{ manufacturerData: [ 
                  {  
                    companyIdentifier: 0x004c,            // Apple 
                    dataPrefix: new Uint8Array([0x12])    // Airtag
               }],
      optionalServices: [&#39;battery_service&#39;]  
     }]   
  })
</code></pre><p><a href="/blog/bluetooth/scan.html">A simple webpage to check for Airtags is hosted here</a>.</p>
<p><em>Note: It requires Chrome 92+ (<a href="https://chromereleases.googleblog.com/2021/06/chrome-beta-for-android-update_0893144828.html">currently in beta for Android users</a>) to work. Sometimes it seems flacky. I&rsquo;m not sure exactly how frequently an Airtag emits its Bluetooth advertisement. During experiements it seemed that advertisements are only starting to happen after an iPhone using &ldquo;Find My&rdquo; NFC is close by. Overall, this needs more testing.</em></p>
<p><img src="/blog/images/2021/airtag-browser-scan.png" alt="Airtag Browser Scan"></p>
<p>Above you can see a scan run on my Android device which shows that two Airtags are close by.</p>
<h1 id="novel-data-exfiltration">Novel Data Exfiltration</h1>
<p>One thing I was wondering if Apple&rsquo;s Airtag/device tracking network can be used to beaconing out arbitrary data.</p>
<p>The idea would be to piggy-back on Apple&rsquo;s &ldquo;Find My&rdquo; network (<em>offline finding</em>) to do so. Turns out that this is totally possible via fake Airtag Bluetooth advertisements.</p>
<p>The TU Darmstadt published a toolset called <a href="https://github.com/seemoo-lab/openhaystack">OpenHayStack</a> and there was another article I found about a tool call <a href="https://positive.security/blog/send-my">send-my</a>.</p>
<p>All that is needed seems to have a simple Windows app that performs <strong>Bluetooth advertisements</strong> according to the two articles above to send data out via nearby Airtags.</p>
<p>This will be one of my upcoming weekend projects. :)</p>
<h2 id="conclusion">Conclusion</h2>
<p>Airtags and other tracking devices enable stalkers, and its quite scary how easy a stalking device can be created. Let&rsquo;s hope that we soon see more common frequency tracking apps that can raise alerts, ideally built into the Operating Systems.</p>
<p>It&rsquo;s also worth keeping an eye on potential data exfiltration attacks that seem possible via Airtags, although throughput appears quite limited.</p>
<p>Cheers,
<a href="https://twitter.com/wunderwuzzi23">@wunderwuzzi23</a></p>
<h2 id="references">References</h2>
<ol>
<li><a href="https://www.igeeksblog.com/best-airtag-alternatives/">Best Airtag alternatives</a></li>
<li><a href="https://arxiv.org/pdf/2103.02282.pdf">Recent research by the TU Darmstadt</a></li>
<li><a href="https://chromereleases.googleblog.com/2021/06/chrome-beta-for-android-update_0893144828.html">Chrome 92 Beta Release Announcement</a></li>
</ol>

  </section>
  <footer>
    
    
    
    <footer></footer><hr/>
    
    <ul class="pager">
      
      <li class="next"><a href="https://embracethered.com/blog/posts/2021/automating-office-to-achieve-redteaming-objectives/">Newer <span aria-hidden="true">&rarr;</span></a></li>
      
      
      <li class="author-contact">
        <a href="mailto:security@wunderwuzzi.net">
          <i class="fa fa-envelope-o" aria-hidden="true"></i>
          &nbsp;Contact me
        </a>
     </li>

      
      
      <li class="previous"><a href="https://embracethered.com/blog/posts/2021/somewhere-today-a-company-is-breached/"><span aria-hidden="true">&larr;</span> Older</a></li>
      
    </ul>
  </footer>
</article>
</main>
  <footer class="container global-footer">
    <div class="copyright-note pull-left">
     
     (c) WUNDERWUZZI 2018-2025
     <div class="sns-links hidden-print">
  
  <a href="mailto:security@wunderwuzzi.net">
    <i class="fa fa-envelope"></i>
  </a>
  
  
  <a href="https://twitter.com/wunderwuzzi23" target="_blank">
    <i class="fa fa-twitter"></i>
  </a>
  
  
  
  
  
  <a href="https://github.com/wunderwuzzi23" target="_blank">
    <i class="fa fa-github"></i>
  </a>
  
  
  
  
  
  <a href="https://youtube.com/@embracethered" target="_blank">
    <i class="fa fa-youtube"></i>
  </a>
  
  
  
  <a href="/blog/index.xml" target="_blank">
    <i class="fa fa-rss"></i>
  </a>
</div>
 
     <div style="font-size:small;font-style: italic;color:crimson">
    Disclaimer: Penetration testing requires authorization from proper stakeholders. Information on this blog is provided for research and educational purposes to advance understanding of attacks and countermeasures to help secure the Internet. 
    </div>
    </div>
</footer>
  <script src="https://embracethered.com/blog/js/highlight.pack.js"></script>
  <script>
    hljs.initHighlightingOnLoad();
  </script>
  
  



<script type="text/javascript">
  var _paq = window._paq || [];
  _paq.push(["disableCookies"]);
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="//wuzzi.net/anamato/inc/";
    _paq.push(['setTrackerUrl', u+'rts.php']);
    _paq.push(['setSiteId', '1']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'rts.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<img src="https://wuzzi.net/anamato/inc/rts.php?idsite=1&amp;rec=1" style="border:0;" alt="" />
  
</body>
</html>

