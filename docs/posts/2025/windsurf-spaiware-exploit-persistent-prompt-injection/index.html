<!DOCTYPE html>
<html lang="en-us">
<head prefix="og: http://ogp.me/ns#">
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1" />
  <meta name="description" content=" In this second post about Windsurf Cascade we are exploring the SpAIware attack, which allows memory persistent data exfiltration. SpAIware is an attack we …" />
  <link rel="canonical" href="https://embracethered.com/blog/posts/2025/windsurf-spaiware-exploit-persistent-prompt-injection/" />
  <meta property="og:title" content=" Windsurf: Memory-Persistent Data Exfiltration (SpAIware Exploit) &middot;  Embrace The Red" />
  <meta property="og:description" content=" In this second post about Windsurf Cascade we are exploring the SpAIware attack, which allows memory persistent data exfiltration. SpAIware is an attack we …" />
  <meta property="og:site_name" content="Embrace The Red" />
  <meta property="og:url" content="https://embracethered.com/blog/posts/2025/windsurf-spaiware-exploit-persistent-prompt-injection/" />
  <meta property="og:type" content="article" />
  <meta property="og:article:published_time" content="2025-08-22T15:21:58-07:00" />
  <meta property="og:article:tag" content="llm" />
  <meta property="og:article:tag" content="agents" />
  <meta property="og:article:tag" content="month of ai bugs" />

  <title>
     Windsurf: Memory-Persistent Data Exfiltration (SpAIware Exploit) &middot;  Embrace The Red
  </title>

  <link rel="stylesheet" href="https://embracethered.com/blog/css/bootstrap.min.css" />
  <link rel="stylesheet" href="https://embracethered.com/blog/css/main.css" />
  <link rel="stylesheet" href="https://embracethered.com/blog/css/font-awesome.min.css" />
  <link rel="stylesheet" href="https://embracethered.com/blog/css/github.css" />
  
  <link rel="stylesheet" href="https://embracethered.com/blog/fonts/cachedfonts.css" type="text/css">
  <link rel="shortcut icon" type="image/x-icon" href="https://embracethered.com/blog/images/favicon.ico" />
  <link rel="apple-touch-icon" type="image/x-icon" href="https://embracethered.com/blog/images/favicon.ico" />
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@wunderwuzzi23">
<meta name="twitter:title" content="Windsurf: Memory-Persistent Data Exfiltration (SpAIware Exploit)">
<meta name="twitter:description" content="Windsurf is vulnerable to Prompt Injection and also long-term memory persistence, which allows an adversary to persist malicious instructions for a long period of time, aka. SpAIware attack">
<meta name="twitter:image" content="https://embracethered.com/blog/images/2025/episode22-yt.png">

<meta name="twitter:creator" content="@wunderwuzzi23">



  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Article",
    "headline": "\"Windsurf: Memory-Persistent Data Exfiltration (SpAIware Exploit)\"",
    "description": "\" In this second post about Windsurf Cascade we are exploring the SpAIware attack, which allows memory persistent data exfiltration. SpAIware is an attack we …\"",
    "author": {
      "@type": "Person",
      "name": "wunderwuzzi",
      "url": "https://x.com/wunderwuzzi23"
    },
    "publisher": {
      "@type": "Organization",
      "name": "\"Embrace The Red\"",
      "logo": {
        "@type": "ImageObject",
        "url": "https:\/\/embracethered.com\/blog\/images/favicon.ico"
      }
    },
    "url": "\"https://embracethered.com/blog/posts/2025/windsurf-spaiware-exploit-persistent-prompt-injection/\"",
    "datePublished": "\"2025-08-22T15:21:58-07:00\"","dateModified": "\"2025-08-22T15:21:58-07:00\"",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "\"https://embracethered.com/blog/posts/2025/windsurf-spaiware-exploit-persistent-prompt-injection/\""
    }
  }
  </script>

</head>
<body>
    <header class="global-header"  style="background-image:url( /blog/images/bg.png )">
    <section class="header-text">
      <h1><a href="https://embracethered.com/blog/">Embrace The Red</a></h1>
      
      <div class="tag-line" style="min-width:fit-content; font-weight: 400;">
        wunderwuzzi&#39;s blog
        <br><div style="color: greenyellow; font-weight:400;">learn the hacks, stop the attacks.</div> 
      </div>
      
      <div class="sns-links hidden-print">
  
  <a href="mailto:security@wunderwuzzi.net">
    <i class="fa fa-envelope"></i>
  </a>
  
  
  <a href="https://twitter.com/wunderwuzzi23" target="_blank">
    <i class="fa fa-twitter"></i>
  </a>
  
  
  
  
  
  <a href="https://github.com/wunderwuzzi23" target="_blank">
    <i class="fa fa-github"></i>
  </a>
  
  
  
  
  
  <a href="https://youtube.com/@embracethered" target="_blank">
    <i class="fa fa-youtube"></i>
  </a>
  
  
  
  <a href="/blog/index.xml" target="_blank">
    <i class="fa fa-rss"></i>
  </a>
</div>

      
      <a href="https://embracethered.com/blog/" class="btn-header btn-back hidden-xs">
        <i class="fa fa-angle-left" aria-hidden="true"></i>
        &nbsp;Home
      </a>
      
    
      <a href="/blog/index.xml" class="btn-header btn-rss hidden-xs">
        <i class="fa fa-rss" aria-hidden="true"></i>
        &nbsp;RSS
      </a>
      <a data-formkit-toggle="15376e9e24" href="https://embracethered.kit.com/15376e9e24" class="btn-header btn-subscribe hidden-xs">
        <i class="fa fa-envelope" aria-hidden="true"></i>
        &nbsp;Subscribe
      </a>
    </section>
  </header>
  
  <button data-formkit-toggle="15376e9e24" class="fab-subscribe" id="fab-subscribe" aria-label="Subscribe to newsletter">
    <i class="fa fa-envelope"></i>
  </button>
  <script>
    (function() {
      var subscribed = Object.keys(localStorage).some(function(key) {
        return key.indexOf('cksubscribed-') === 0;
      });
      if (subscribed) {
        var fab = document.getElementById('fab-subscribe');
        if (fab) fab.style.display = 'none';
      }
    })();
  </script>
  <main class="container">


<article>
  <header>
    <h1 class="text-primary">Windsurf: Memory-Persistent Data Exfiltration (SpAIware Exploit)</h1>
    <div class="post-meta clearfix">
    
      <div class="post-date pull-left">
        Posted on
        <time datetime="2025-08-22T15:21:58-07:00">
          Aug 22, 2025
        </time>
      </div>
    
      <div class="pull-right">
        
        <span class="post-tag small"><a href="https://embracethered.com/blog//tags/llm">#llm</a></span>
        
        <span class="post-tag small"><a href="https://embracethered.com/blog//tags/agents">#agents</a></span>
        
        <span class="post-tag small"><a href="https://embracethered.com/blog//tags/month-of-ai-bugs">#month of ai bugs</a></span>
        
      </div>
    </div>
  </header>
  <section>
    
<a id="top_ref"></a>

<p>In this second post about Windsurf Cascade we are exploring the SpAIware attack, which allows memory persistent data exfiltration. <a href="/blog/posts/2024/chatgpt-macos-app-persistent-data-exfiltration/">SpAIware is an attack we first successfully demonstrated with ChatGPT last year</a> and OpenAI mitigated.</p>
<p><a href="/blog/images/2025/episode22-yt.png"><img src="/blog/images/2025/episode22-yt.png" alt="Windsurf-Spaiware-prompt"></a></p>
<p>While inspecting the <a href="https://github.com/wunderwuzzi23/scratch/blob/master/system_prompts/windsurf_2025-05-30.txt">system prompt</a> of Windsurf Cascade I noticed that it has a <code>create_memory</code> tool.</p>
<h2 id="creating-memories">Creating Memories</h2>
<p>The question that immediately popped into my head was if this tool will require human approval when Cascade creates a long-term memory, or if it is added automatically.</p>
<p>Turns out the memory tool is automatically invoked, and this means we can exploit this memory feature to persist false information, but we can also persist prompt injection instructions that remain present for future conversations.</p>
<p><strong>SpAIware compromises confidentiality, integrity and availability of all future chat conversations.</strong></p>
<h3 id="disclaimer">Disclaimer</h3>
<p>Windsurf had been unresponsive since I reported this end of May, so this post does not disclose all technical details or prompt injection payloads. The goal for now is to raise awareness of the SpAIware attack chain and inform users, so they can keep looking out for potentially malicious memories the agent added.</p>
<p><strong>Update 1: Windsurf responded and will be working on fixes! I will share unredacted info and also the detailed video once the data-exfil issues are addressed.</strong></p>
<p><strong>As end-user, you can mitigate this threat of long-term compromise by regularly reviewing the stored long-term memories to make sure there is nothing nefarious.</strong></p>
<h2 id="spaiware-background-information">SpAIware Background Information</h2>
<p>Recall the <a href="blog/posts/2024/chatgpt-macos-app-persistent-data-exfiltration/">SpAIware exploit demonstrated with ChatGPT from last year</a>, where I first showed how one can persist malicious instructions in memory and then continuously exfiltrated all information the user types and responses from ChatGPT. The attack can also send new instructions to the client to invoke other tools, etc. This means achieving full remote command and control purely through prompt injection.</p>
<h3 id="black-hat-talk-and-blog-post">Black Hat Talk and Blog Post</h3>
<p>For further information check out my <a href="https://www.youtube.com/watch?v=84NVG1c5LRI">SpAIware &amp; More: Advanced Prompt Injection Exploits in LLM Applications</a> Black Hat talk from last year to see this in action. There is also a <a href="/blog/posts/2025/spaiware-and-chatgpt-command-and-control-via-prompt-injection-zombai/">corresponding blog post about AI Domination</a>.</p>
<p>Now, let&rsquo;s explore this threat more closely with Windsurf.</p>
<h2 id="youtube-video---walkthrough">YouTube Video - Walkthrough</h2>
<p>Since Windsurf reached out yesterday, I&rsquo;m not sharing the video until at least the data exfil issues are mitigated.</p>
<h2 id="spaiware-and-windsurf-cascade">SpAIware and Windsurf Cascade</h2>
<p>An attacker can invoke the <code>create_memory</code> tool during an indirect prompt injection attack without a human having to approve it.</p>
<p>This has multiple implications:</p>
<ol>
<li>An attacker can persist instructions into future chat sessions (like always adding certain backdoors or provide false information)</li>
<li>Combined with the <a href="/blog/posts/windsurf-data-exfiltration-vulnerabilities/">data exfiltration vulnerabilities described in previous posts</a>,  an adversary can persist prompt injection instructions to continuously exfiltrate information.</li>
</ol>
<p>The idea of memory persistence is actually quite scary and underestimated in the industry I believe.</p>
<p>Now, let&rsquo;s look at the proof-of-concept exploit in detail.</p>
<h2 id="prompt-injection-payload">Prompt Injection Payload</h2>
<p><strong>Note: Redacted some details, until at least the data-exfil issues are fixed</strong></p>
<p>As with the examples before, let&rsquo;s keep it simple and place the prompt injection into a source code file, as a comment. In this case let&rsquo;s make it a C program:</p>
<p><a href="/blog/images/2025/windsurf-spaiware-code-redacted.png"><img src="/blog/images/2025/windsurf-spaiware-code-redacted.png" alt="Windsurf-Spaiware-prompt"></a></p>
<p>This screenshot shows how the attack works, the developer analyzes a file. The file does not have to be open in the IDE, this is just to explain it easier:<br>
<a href="/blog/images/2025/windsurf-spaiware1-redacted.png"><img src="/blog/images/2025/windsurf-spaiware1-redacted.png" alt="Windsurf-Spaiware-prompt"></a></p>
<p>You can see the prompt injection works and the <code>create_memory</code> tool is invoked.</p>
<p><strong>That something happened is visible by the area I highlighted in the bottom right of the image.</strong> A user might not notice this, and furthermore, they might not even know where to find and inspect the memory later.</p>
<p><strong>As user, familiarize yourself with this feature and check your memories. During regular use I had it happen a few times that a memory was added that I didn&rsquo;t catch right away.</strong></p>
<p>If you are curious, you can navigate to Windsurf&rsquo;s settings to inspect persistent memories, it takes a couple of clicks, but this is what got stored:<br>
<a href="/blog/images/2025/windsurf-spaiware2-redacted.png"><img src="/blog/images/2025/windsurf-spaiware2-redacted.png" alt="Windsurf-SpAIware-Stored"></a></p>
<p>An attacker can make the image 1 pixel and also transparent, so it becomes invisible in the user interface:<br>
<a href="/blog/images/2025/windsurf-spaiware-4-redacted.png"><img src="/blog/images/2025/windsurf-spaiware-4-redacted.png" alt="Windsurf-spaiware-unnoticed"></a></p>
<p>And, in above screenshot you can also see the log file of the server, which shows that the third-party web server indeed received details about the conversation</p>
<h2 id="responsible-disclosure">Responsible Disclosure</h2>
<p>I disclosed this vulnerability to Windsurf on May 30, 2025, which they acknowledged a few days later. Further inquiries remained unanswered. Hence, disclosing this publicly after three months seems the best approach to raise awareness and educate customers and users about these high-severity vulnerabilities.</p>
<p><strong>Update: Windsurf reached out that they will be working on fixes, although no ETA yet. I will update and share unredacted information once the fixes are out.</strong></p>
<h2 id="mitigations">Mitigations</h2>
<ul>
<li>Systems should suggest memories to the user, rather than automatically adding them. Other coding agents, like Devin and Manus, follow such an approach.</li>
<li>Do not render images/hyperlinks to untrusted domains. VS Code has an allow list of trusted domains, so it might be best to integrate with that feature.</li>
<li><strong>As a user, inspect memories regularly to ensure no malicious entries were added</strong></li>
</ul>
<h2 id="conclusion">Conclusion</h2>
<p>Windsurf Cascade is not in a sandbox (e.g. Content Security Policy) and also has the capability to store long-term memories. The combination of no sandboxing and automatic memory persistence can lead to SpAIware-style attacks. This is an attacker technique I <a href="/blog/posts/2024/chatgpt-macos-app-persistent-data-exfiltration/">first introduced last year with ChatGPT</a>.</p>
<p>In this post we showed how an attacker can exploit this via a prompt injection attack (e.g content in a GitHub issue, source code or from another website) to install persistent instructions into long-term memory that compromise the confidentiality, integrity and availability of all future chat conversations.</p>
<h2 id="references">References</h2>
<ul>
<li><a href="https://simonwillison.net/2025/Jun/16/the-lethal-trifecta/">Simon Willison - The lethal trifecta</a></li>
<li><a href="https://monthofaibugs.com">Month of AI Bugs 2025</a></li>
<li><a href="https://github.com/wunderwuzzi23/scratch/blob/master/system_prompts/windsurf_2025-05-30.txt">Windsurf System Prompt</a></li>
<li><a href="https://embracethered.com/blog/posts/2024/github-copilot-chat-prompt-injection-data-exfiltration/">GitHub Copilot Data Exfiltration Fix</a></li>
<li><a href="https://techcrunch.com/2025/07/11/windsurfs-ceo-goes-to-google-openais-acquisition-falls-apart/">Windsurf&rsquo;s CEO goes to Google; OpenAI&rsquo;s acquisition falls apart</a></li>
<li><a href="/blog/posts/2024/chatgpt-macos-app-persistent-data-exfiltration/">Spyware Injection Into Your ChatGPT&rsquo;s Long-Term Memory (SpAIware)</a></li>
</ul>

  </section>
  <footer>
    
    
    
    <footer></footer><hr/>
    
    <ul class="pager">
      
      <li class="next"><a href="https://embracethered.com/blog/posts/2025/windsurf-sneaking-invisible-instructions-for-prompt-injection/">Newer <span aria-hidden="true">&rarr;</span></a></li>
      
      
      <li class="author-contact">
        <a href="mailto:security@wunderwuzzi.net">
          <i class="fa fa-envelope-o" aria-hidden="true"></i>
          &nbsp;Contact me
        </a>
     </li>

      
      
      <li class="previous"><a href="https://embracethered.com/blog/posts/2025/windsurf-data-exfiltration-vulnerabilities/"><span aria-hidden="true">&larr;</span> Older</a></li>
      
    </ul>
  </footer>
</article>
</main>
  <footer class="container global-footer">
    <div class="copyright-note pull-left">
     
     (c) WUNDERWUZZI 2018-2026
     <div class="sns-links hidden-print">
  
  <a href="mailto:security@wunderwuzzi.net">
    <i class="fa fa-envelope"></i>
  </a>
  
  
  <a href="https://twitter.com/wunderwuzzi23" target="_blank">
    <i class="fa fa-twitter"></i>
  </a>
  
  
  
  
  
  <a href="https://github.com/wunderwuzzi23" target="_blank">
    <i class="fa fa-github"></i>
  </a>
  
  
  
  
  
  <a href="https://youtube.com/@embracethered" target="_blank">
    <i class="fa fa-youtube"></i>
  </a>
  
  
  
  <a href="/blog/index.xml" target="_blank">
    <i class="fa fa-rss"></i>
  </a>
</div>
 
     <div style="font-size:small;font-style: italic;color:crimson">
    Disclaimer: Penetration testing requires authorization from proper stakeholders. Information on this blog is provided for research and educational purposes to advance understanding of attacks and countermeasures to help secure the Internet. | <a href="https://embracethered.com/blog/privacy.txt">Privacy</a>
    </div>
    </div>
</footer>
  <script src="https://embracethered.com/blog/js/highlight.pack.js"></script>
  <script>
    hljs.initHighlightingOnLoad();
  </script>
  
  



<script type="text/javascript">
  var _paq = window._paq || [];
  _paq.push(["disableCookies"]);
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="//wuzzi.net/anamato/inc/";
    _paq.push(['setTrackerUrl', u+'rts.php']);
    _paq.push(['setSiteId', '1']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'rts.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<img src="https://wuzzi.net/anamato/inc/rts.php?idsite=1&amp;rec=1" style="border:0;" alt="" />


<div class="kit-subscribe-wrapper">
  <script async data-uid="15376e9e24" src="https://embracethered.kit.com/15376e9e24/index.js"></script>
</div>

</body>
</html>

