<!DOCTYPE html>
<html lang="en-us">
<head prefix="og: http://ogp.me/ns#">
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1" />
  <meta property="og:title" content=" Hosting COM Servers with an MCP Server &middot;  Embrace The Red" />
  
  <meta property="og:site_name" content="Embrace The Red" />
  <meta property="og:url" content="https://embracethered.com/blog/posts/2025/mcp-com-server-automate-anything-on-windows/" />
  
  
  <meta property="og:type" content="article" />
  
  <meta property="og:article:published_time" content="2025-06-08T22:30:40-07:00" />
  
  <meta property="og:article:tag" content="threats" />
  
  <meta property="og:article:tag" content="ttp" />
  
  <meta property="og:article:tag" content="red" />
  
  <meta property="og:article:tag" content="tools" />
  
  <meta property="og:article:tag" content="llm" />
  
  

  <title>
     Hosting COM Servers with an MCP Server &middot;  Embrace The Red
  </title>

  <link rel="stylesheet" href="https://embracethered.com/blog/css/bootstrap.min.css" />
  <link rel="stylesheet" href="https://embracethered.com/blog/css/main.css" />
  <link rel="stylesheet" href="https://embracethered.com/blog/css/font-awesome.min.css" />
  <link rel="stylesheet" href="https://embracethered.com/blog/css/github.css" />
  
  <link rel="stylesheet" href="https://embracethered.com/blog/fonts/cachedfonts.css" type="text/css">
  <link rel="shortcut icon" type="image/x-icon" href="https://embracethered.com/blog/images/favicon.ico" />
  <link rel="apple-touch-icon" type="image/x-icon" href="https://embracethered.com/blog/images/favicon.ico" />
  

  
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@wunderwuzzi23">
<meta name="twitter:title" content="AI powered Windows Automation: Hosting COM Servers with an MCP Server ðŸ¤¯">
<meta name="twitter:description" content="An MCP Server that can host COM servers for advanced Windows Automation">
<meta name="twitter:image" content="https://embracethered.com/blog/images/2025/com-tn.jpg">

<meta name="twitter:creator" content="@wunderwuzzi23">



  
</head>
<body>
    <header class="global-header"  style="background-image:url( /blog/images/bg.png )">
    <section class="header-text">
      <h1><a href="https://embracethered.com/blog/">Embrace The Red</a></h1>
      
      <div class="tag-line" style="min-width:fit-content; font-weight: 400;">
        wunderwuzzi&#39;s blog
        <br><a style="color: greenyellow; font-weight:300;text-decoration: underline; " href="https://www.amazon.com/gp/product/1838828869/ref=as_li_tl?ie=UTF8&camp=1789&creative=9325&creativeASIN=1838828869&linkCode=as2&tag=wunderwuzzi-20&linkId=b6523e937607be47499c6010ff489537">OUT NOW: Cybersecurity Attacks - Red Team Strategies</a> 
      </div>
      
      <div class="sns-links hidden-print">
  
  <a href="mailto:security@wunderwuzzi.net">
    <i class="fa fa-envelope"></i>
  </a>
  
  
  <a href="https://twitter.com/wunderwuzzi23" target="_blank">
    <i class="fa fa-twitter"></i>
  </a>
  
  
  
  
  
  <a href="https://github.com/wunderwuzzi23" target="_blank">
    <i class="fa fa-github"></i>
  </a>
  
  
  
  
  
  <a href="https://youtube.com/@embracethered" target="_blank">
    <i class="fa fa-youtube"></i>
  </a>
  
  
  
  <a href="/blog/index.xml" target="_blank">
    <i class="fa fa-rss"></i>
  </a>
</div>

      
      <a href="https://embracethered.com/blog/" class="btn-header btn-back hidden-xs">
        <i class="fa fa-angle-left" aria-hidden="true"></i>
        &nbsp;Home
      </a>
      
    
      <a href="/blog/index.xml" class="btn-header btn-subscribe hidden-xs">
        <i class="fa fa-rss" aria-hidden="true"></i>
        &nbsp;Subscribe
      </a>
    </section>
  </header>
  <main class="container">


<article>
  <header>
    <h1 class="text-primary">Hosting COM Servers with an MCP Server</h1>
    <div class="post-meta clearfix">
    
      <div class="post-date pull-left">
        Posted on
        <time datetime="2025-06-08T22:30:40-07:00">
          Jun 8, 2025
        </time>
      </div>
    
      <div class="pull-right">
        
        <span class="post-tag small"><a href="https://embracethered.com/blog//tags/threats">#threats</a></span>
        
        <span class="post-tag small"><a href="https://embracethered.com/blog//tags/ttp">#ttp</a></span>
        
        <span class="post-tag small"><a href="https://embracethered.com/blog//tags/red">#red</a></span>
        
        <span class="post-tag small"><a href="https://embracethered.com/blog//tags/tools">#tools</a></span>
        
        <span class="post-tag small"><a href="https://embracethered.com/blog//tags/llm">#llm</a></span>
        
      </div>
    </div>
  </header>
  <section>
    <p>When the <a href="https://modelcontextprotocol.io/introduction">Model Context Protocol</a> (MCP) came out it reminded me of the <a href="https://learn.microsoft.com/en-us/windows/win32/com/the-component-object-model">Common Object Model</a> (COM) from Microsoft.</p>
<p><code>COM</code> has been around for decades and it&rsquo;s used for programming, scripting, sharing of functionality at a binary/object level across languages and hosts. Via <code>DCOM</code> all of this can even be done remotely, and well, it&rsquo;s also useful for red teaming. A lot of software on Windows was/is implemented as <code>COM objects</code>, including Microsoft Office.</p>
<p><strong>Here are some of the similarities of the two standards:</strong></p>
<ul>
<li>Interface-based Communication and Abstraction</li>
<li>Scripting and Automation</li>
<li>Integration with External Tools and Services</li>
<li>Local and Remote Server Options</li>
</ul>
<p><strong>So, I thought why not build an MCP server for fun that abstracts COM - essentially, an MCP server for Windows and Office Automation.</strong></p>
<h2 id="dynamic-discovery">Dynamic Discovery</h2>
<p>Due to the dynamic discovery nature of COM, all that should be needed is the <code>CLSID</code> or the <code>ProgID</code> to launch, interact and script any COM object.</p>
<p>And I wanted an MCP server that can host many COM objects at the same time, a proper host.</p>
<h2 id="welcome-the-mcp-com-server">Welcome the MCP COM Server</h2>
<p>To get the prototype off the ground, I did some vibe coding and a few hours later, including some intense manual debugging to figure out and fix issues, it worked!</p>
<p><a href="/blog/images/2025/claude-com-mcp-excel.jpg"><img src="/blog/images/2025/claude-com-mcp-excel.jpg" alt="basic excel com-mcp-server"></a></p>
<p>The <code>mcp-com-server</code> offers these <code>COM</code> like tools:</p>
<ul>
<li><code>CreateObject</code> (basically <code>CoCreateInstance</code>, in Visual Basic it was <code>CreateObject</code>)</li>
<li><code>Get/Set Property</code></li>
<li><code>InvokeMethod</code></li>
<li><code>QueryInterface</code></li>
<li><code>ListAllHostedServers</code>: This allows to list all the currently active servers that are hosted.</li>
</ul>
<h3 id="challenges">Challenges</h3>
<p>The main challenge I had was to create a work-around for when calling <code>Invoke</code> or <code>Get/Set Property</code> on a COM object actually returns a new <code>COM object</code>. That corner case was not anticipated until I did testing, and it took time to figure out how to abstract that via MCP, and it&rsquo;s probably a bit hacky at the moment, but it works. There are likely more such edge cases.</p>
<h3 id="security">Security</h3>
<p>As you can imagine, instantiating any <code>COM server</code> means, the MCP server can open a <code>Shell.Application</code> or <code>FileSystemObject</code> and perform dangerous operations.</p>
<p>As a basic mitigation there is an Allow List for <code>CLSID</code>s and <code>ProgIDs</code>, and the MCP server will instantiate allow listed COM objects. This could be expanded to include specific interfaces/methods as well. Overall, like with a lot of MCP servers, it&rsquo;s risky business.</p>
<p>But it offered a great learning opportunity. For me to learn about new tech, it&rsquo;s important to actually build something with it - even if it&rsquo;s just for fun.</p>
<h2 id="the-result---automating-excel">The Result - Automating Excel</h2>
<p>The result is pretty impressive! After connecting the MCP server with Claude it can create, open and edit Excel files, save them, then open Outlook and send them via email. Pretty cool stuff.</p>
<p><a href="/blog/images/2025/claude-mcp-com-excel.png"><img src="/blog/images/2025/claude-mcp-com-excel.png" alt="basic interaction com-mcp-server"></a></p>
<p>There is also <code>SAPI</code> COM object that I used to have Claude speak. There are many other capabilities available with COM.</p>
<h3 id="confirmation-dialogs">Confirmation Dialogs</h3>
<p>Claude shows an <code>Allow</code>/<code>Deny</code> button before invoking custom tools by default. That is a good mitigation to make sure a human remains in the loop. This can be disabled, but also re-enabled in the Claude Settings per MCP tool.</p>
<h3 id="ai-driven-windows-and-office-automation">AI-Driven Windows and Office Automation</h3>
<p>This opens up the door for interesting automation avenues, like AI agents that can perform precise actions at the API/COM level, rather than depending on clicking on UI elements.</p>
<h3 id="offensive-security">Offensive Security</h3>
<p>This is useful for general Windows and Office automation tasks. However in the long run I want to explore how this fits into the red teaming, as <a href="https://embracethered.com/blog/posts/2021/automating-office-to-achieve-redteaming-objectives/">COM has a place there</a>.</p>
<h3 id="claude-using-internet-explorer---we-got-you-covered-">Claude using Internet Explorer - we got you covered! ðŸ¤“</h3>
<p>At the very end, I was curious if Claude could resurrect the Internet Explorer on Windows, and it can.</p>
<p><a href="/blog/images/2025/claude-com-frankenclaude.jpg"><img src="/blog/images/2025/claude-com-frankenclaude.jpg" alt="frankenclaude"></a></p>
<p><strong>We got a Franken Claude!</strong></p>
<h2 id="source-code">Source Code</h2>
<p>After posting about this a few months ago on X, a few followers asked me about the code.</p>
<p>You can find the source code on <a href="https://github.com/wunderwuzzi23/mcp-com-server">GitHub</a>. Keep in mind that this was mainly for me to learn about MCP and implement a server, rather then a serious production project - but the idea probably has potential.</p>
<h2 id="conclusion">Conclusion</h2>
<p>This demonstrates the power of MCP in combination with COM, and how one can build a quite sophisticated Windows automation MCP server that allows to control many aspects of Windows and Office, and a lot more.</p>
<p>It&rsquo;s always a good idea to implement and use new tech to learn about the risks from first principle. So, I always encourage people asking for advice to not just try to break things, but also actually go and build things from scratch. As that helps with brainstorming and gathering ideas for how someone might abuse certain parts, and generally just to see what pitfalls and security bugs might easily get introduced.</p>
<p>Happy hacking.</p>
<h2 id="references">References</h2>
<ul>
<li><a href="https://github.com/wunderwuzzi23/mcp-com-server">mcp-com-server GitHub project</a></li>
<li><a href="https://learn.microsoft.com/en-us/windows/win32/com/the-component-object-model">Common Object Model</a></li>
<li><a href="https://embracethered.com/blog/posts/2021/automating-office-to-achieve-redteaming-objectives/">Automating Office To Achieve Red Teaming Objectives</a></li>
<li><a href="https://modelcontextprotocol.io/introduction">MCP</a></li>
</ul>

  </section>
  <footer>
    
    
    
    <footer></footer><hr/>
    
    <ul class="pager">
      
      <li class="next"><a href="https://embracethered.com/blog/posts/2025/security-advisory-anthropic-slack-mcp-server-data-leakage/">Newer <span aria-hidden="true">&rarr;</span></a></li>
      
      
      <li class="author-contact">
        <a href="mailto:security@wunderwuzzi.net">
          <i class="fa fa-envelope-o" aria-hidden="true"></i>
          &nbsp;Contact me
        </a>
     </li>

      
      
      <li class="previous"><a href="https://embracethered.com/blog/posts/2025/ai-clickfix-ttp-claude/"><span aria-hidden="true">&larr;</span> Older</a></li>
      
    </ul>
  </footer>
</article>
</main>
  <footer class="container global-footer">
    <div class="copyright-note pull-left">
     
     (c) WUNDERWUZZI 2018-2025
     <div class="sns-links hidden-print">
  
  <a href="mailto:security@wunderwuzzi.net">
    <i class="fa fa-envelope"></i>
  </a>
  
  
  <a href="https://twitter.com/wunderwuzzi23" target="_blank">
    <i class="fa fa-twitter"></i>
  </a>
  
  
  
  
  
  <a href="https://github.com/wunderwuzzi23" target="_blank">
    <i class="fa fa-github"></i>
  </a>
  
  
  
  
  
  <a href="https://youtube.com/@embracethered" target="_blank">
    <i class="fa fa-youtube"></i>
  </a>
  
  
  
  <a href="/blog/index.xml" target="_blank">
    <i class="fa fa-rss"></i>
  </a>
</div>
 
     <div style="font-size:small;font-style: italic;color:crimson">
    Disclaimer: Penetration testing requires authorization from proper stakeholders. Information on this blog is provided for research and educational purposes to advance understanding of attacks and countermeasures to help secure the Internet. 
    </div>
    </div>
</footer>
  <script src="https://embracethered.com/blog/js/highlight.pack.js"></script>
  <script>
    hljs.initHighlightingOnLoad();
  </script>
  
  



<script type="text/javascript">
  var _paq = window._paq || [];
  _paq.push(["disableCookies"]);
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="//wuzzi.net/anamato/inc/";
    _paq.push(['setTrackerUrl', u+'rts.php']);
    _paq.push(['setSiteId', '1']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'rts.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<img src="https://wuzzi.net/anamato/inc/rts.php?idsite=1&amp;rec=1" style="border:0;" alt="" />
  
</body>
</html>

