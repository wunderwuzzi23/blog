<!DOCTYPE html>
<html lang="en-us">
<head prefix="og: http://ogp.me/ns#">
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1" />
  <meta property="og:title" content=" Sneaking Invisible Instructions by Developers in Windsurf &middot;  Embrace The Red" />
  
  <meta property="og:site_name" content="Embrace The Red" />
  <meta property="og:url" content="https://embracethered.com/blog/posts/2025/windsurf-sneaking-invisible-instructions-for-prompt-injection/" />
  
  
  <meta property="og:type" content="article" />
  
  <meta property="og:article:published_time" content="2025-08-23T16:20:58-07:00" />
  
  <meta property="og:article:tag" content="llm" />
  
  <meta property="og:article:tag" content="agents" />
  
  <meta property="og:article:tag" content="month of ai bugs" />
  
  

  <title>
     Sneaking Invisible Instructions by Developers in Windsurf &middot;  Embrace The Red
  </title>

  <link rel="stylesheet" href="https://embracethered.com/blog/css/bootstrap.min.css" />
  <link rel="stylesheet" href="https://embracethered.com/blog/css/main.css" />
  <link rel="stylesheet" href="https://embracethered.com/blog/css/font-awesome.min.css" />
  <link rel="stylesheet" href="https://embracethered.com/blog/css/github.css" />
  
  <link rel="stylesheet" href="https://embracethered.com/blog/fonts/cachedfonts.css" type="text/css">
  <link rel="shortcut icon" type="image/x-icon" href="https://embracethered.com/blog/images/favicon.ico" />
  <link rel="apple-touch-icon" type="image/x-icon" href="https://embracethered.com/blog/images/favicon.ico" />
  

  
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@wunderwuzzi23">
<meta name="twitter:title" content="Sneaking Invisible Instructions by Developers in Windsurf">
<meta name="twitter:description" content="A vulnerability in Windsurf Cascade allows malicious instructions to be hidden from developers but followed by the AI, leading to potential data exfiltration. Learn how this &#39;invisible&#39; attack works.">
<meta name="twitter:image" content="https://embracethered.com/blog/images/2025/episode23-yt.png">

<meta name="twitter:creator" content="@wunderwuzzi23">



  
</head>
<body>
    <header class="global-header"  style="background-image:url( /blog/images/bg.png )">
    <section class="header-text">
      <h1><a href="https://embracethered.com/blog/">Embrace The Red</a></h1>
      
      <div class="tag-line" style="min-width:fit-content; font-weight: 400;">
        wunderwuzzi&#39;s blog
        <br><div style="color: greenyellow; font-weight:400;">learn the hacks, stop the attacks.</div> 
      </div>
      
      <div class="sns-links hidden-print">
  
  <a href="mailto:security@wunderwuzzi.net">
    <i class="fa fa-envelope"></i>
  </a>
  
  
  <a href="https://twitter.com/wunderwuzzi23" target="_blank">
    <i class="fa fa-twitter"></i>
  </a>
  
  
  
  
  
  <a href="https://github.com/wunderwuzzi23" target="_blank">
    <i class="fa fa-github"></i>
  </a>
  
  
  
  
  
  <a href="https://youtube.com/@embracethered" target="_blank">
    <i class="fa fa-youtube"></i>
  </a>
  
  
  
  <a href="/blog/index.xml" target="_blank">
    <i class="fa fa-rss"></i>
  </a>
</div>

      
      <a href="https://embracethered.com/blog/" class="btn-header btn-back hidden-xs">
        <i class="fa fa-angle-left" aria-hidden="true"></i>
        &nbsp;Home
      </a>
      
    
      <a href="/blog/index.xml" class="btn-header btn-subscribe hidden-xs">
        <i class="fa fa-rss" aria-hidden="true"></i>
        &nbsp;Subscribe
      </a>
    </section>
  </header>
  <main class="container">


<article>
  <header>
    <h1 class="text-primary">Sneaking Invisible Instructions by Developers in Windsurf</h1>
    <div class="post-meta clearfix">
    
      <div class="post-date pull-left">
        Posted on
        <time datetime="2025-08-23T16:20:58-07:00">
          Aug 23, 2025
        </time>
      </div>
    
      <div class="pull-right">
        
        <span class="post-tag small"><a href="https://embracethered.com/blog//tags/llm">#llm</a></span>
        
        <span class="post-tag small"><a href="https://embracethered.com/blog//tags/agents">#agents</a></span>
        
        <span class="post-tag small"><a href="https://embracethered.com/blog//tags/month-of-ai-bugs">#month of ai bugs</a></span>
        
      </div>
    </div>
  </header>
  <section>
    
<a id="top_ref"></a>

<p>Imagine a malicious instruction hidden in plain sight, invisible to you but not to the AI. This is a vulnerability discovered in Windsurf Cascade, it follows invisible instructions. This means there can be instructions in a file or result of a tool call that the developer cannot see, but the LLM does.</p>
<p><a href="/blog/images/2025/episode23-yt.png"><img src="/blog/images/2025/episode23-yt.png" alt="Episode 23"></a></p>
<p>Some LLMs interpret invisible Unicode Tag characters as instructions, which can lead to hidden prompt injection.</p>
<p>As far as I can tell the Windsurf <code>SWE-1</code> model can also &ldquo;see&rdquo; these invisible characters, but the <code>SWE-1</code> is not yet capable of interpreting them as instructions. As capabilities improve, so will the risk and impact of hidden prompt injections.</p>
<p>However, Windsurf supports models that reliably interpret these invisible instructions.</p>
<h2 id="demonstration-">Demonstration ðŸ§ª</h2>
<p>Here is a simple demo that shows an empty appearing file, but it actually contains hidden instructions. The model used is Claude Sonnet 3.7:</p>
<p><a href="/blog/images/2025/windsurf-mini-demo-invisible-prompt-injection.png"><img src="/blog/images/2025/windsurf-mini-demo-invisible-prompt-injection.png" alt="Windsurf-Invisible-Tool-Invocation"></a></p>
<p>Windsurf Cascade sees these invisible characters as instructions and <strong>invokes the web tool.</strong></p>
<p>If you pay close attention to the screenshot, you can actually see that the tiny preview pane in Windsurf shows the visible text!</p>
<p>As we have seen with <a href="/blog/posts/2025/windsurf-data-exfiltration-vulnerabilities/">previous posts</a>, automatic tool invocation like this can lead to information disclosure, data exfiltration, and worse&hellip; And leveraging hidden instructions allows a potential attack to remain undetected by the user.</p>
<p>Compared to the impact of automatic tool invocation, invisible instructions are a lower severity issue.</p>
<p><strong>But the key point is: invisible instructions can invoke tools.</strong></p>
<h2 id="additional-background-information">Additional Background Information</h2>
<p>This behavior with LLMs was <a href="https://x.com/goodside/status/1745511940351287394">discovered</a> by Riley Goodside with ChatGPT and was fixed by OpenAI. Since then, I have written about it quite frequently, <a href="/blog/posts/2024/hiding-and-finding-text-with-unicode-tags/">going back to January 2024</a>. I also built the <a href="/blog/ascii-smuggler.html">ASCII Smuggler</a> to help with testing to show actual impact on system and application security.</p>
<h2 id="mitigation">Mitigation</h2>
<p>I suggest making the characters visible in the UI, so that it&rsquo;s clear that there is some hidden information.</p>
<p>Many other apps and agents decided to remove invisible Unicode Tag characters entirely before and after inference. That is probably the most practical mitigation.</p>
<p>Many coding agents, like <a href="/blog/posts/2025/amp-code-fixed-invisible-prompt-injection/">Amp</a> and <a href="/blog/posts/2025/amazon-q-developer-interprets-hidden-instructions/">Amazon Q Developer for VS Code</a> mitigate this at the application level, which is an effective mitigation for models that support invisible instructions. Many other agents remain susceptible to such attacks.</p>
<h2 id="responsible-disclosure">Responsible Disclosure</h2>
<p>This information was disclosed to Windsurf May 30, 2025 and receipt acknowledged by Windsurf a few days later. However, all further inquiries remained unanswered, hence disclosing this publicly seems the best approach to raise awareness and educate users.</p>
<p><strong>Update: After starting the disclosure process as part of Month of AI Bugs, I was contacted by Windsurf, and the team is looking to implement fixes and mitigations for the disclosed vulnerabilities.</strong></p>
<h2 id="conclusion">Conclusion</h2>
<p>Invisible instructions via Unicode Tag characters can be a sneaky way to remain undetected as an adversary. We have seen other coding agents mitigate this at the application level. If you are building exclusively on top of OpenAI models, you should be good, as OpenAI is generally mitigating this threat at the model/API level.</p>
<p>However, there are plenty of apps and models (Google, Anthropic, Grok, Windsurf Cascade,&hellip;) that remain susceptible to this behavior.</p>
<p>If you build an app on top of a model which has this behavior, then consider taking extra steps to protect or inform end-users of invisible text being present.</p>
<h2 id="references">References</h2>
<ul>
<li><a href="https://monthofaibugs.com">Month of AI Bugs 2025</a></li>
<li><a href="/blog/ascii-smuggler.html">ASCII Smuggler tool</a></li>
<li><a href="https://x.com/goodside/status/1745511940351287394">Riley Goodside - Initial Discovery</a></li>
</ul>

  </section>
  <footer>
    
    
    
    <footer></footer><hr/>
    
    <ul class="pager">
      
      <li class="next"><a href="https://embracethered.com/blog/posts/2025/chatgpt-deep-research-connectors-data-spill-and-leaks/">Newer <span aria-hidden="true">&rarr;</span></a></li>
      
      
      <li class="author-contact">
        <a href="mailto:security@wunderwuzzi.net">
          <i class="fa fa-envelope-o" aria-hidden="true"></i>
          &nbsp;Contact me
        </a>
     </li>

      
      
      <li class="previous"><a href="https://embracethered.com/blog/posts/2025/windsurf-spaiware-exploit-persistent-prompt-injection/"><span aria-hidden="true">&larr;</span> Older</a></li>
      
    </ul>
  </footer>
</article>
</main>
  <footer class="container global-footer">
    <div class="copyright-note pull-left">
     
     (c) WUNDERWUZZI 2018-2026
     <div class="sns-links hidden-print">
  
  <a href="mailto:security@wunderwuzzi.net">
    <i class="fa fa-envelope"></i>
  </a>
  
  
  <a href="https://twitter.com/wunderwuzzi23" target="_blank">
    <i class="fa fa-twitter"></i>
  </a>
  
  
  
  
  
  <a href="https://github.com/wunderwuzzi23" target="_blank">
    <i class="fa fa-github"></i>
  </a>
  
  
  
  
  
  <a href="https://youtube.com/@embracethered" target="_blank">
    <i class="fa fa-youtube"></i>
  </a>
  
  
  
  <a href="/blog/index.xml" target="_blank">
    <i class="fa fa-rss"></i>
  </a>
</div>
 
     <div style="font-size:small;font-style: italic;color:crimson">
    Disclaimer: Penetration testing requires authorization from proper stakeholders. Information on this blog is provided for research and educational purposes to advance understanding of attacks and countermeasures to help secure the Internet. 
    </div>
    </div>
</footer>
  <script src="https://embracethered.com/blog/js/highlight.pack.js"></script>
  <script>
    hljs.initHighlightingOnLoad();
  </script>
  
  



<script type="text/javascript">
  var _paq = window._paq || [];
  _paq.push(["disableCookies"]);
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="//wuzzi.net/anamato/inc/";
    _paq.push(['setTrackerUrl', u+'rts.php']);
    _paq.push(['setSiteId', '1']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'rts.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<img src="https://wuzzi.net/anamato/inc/rts.php?idsite=1&amp;rec=1" style="border:0;" alt="" />
  
</body>
</html>

