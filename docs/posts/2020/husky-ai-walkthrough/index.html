<!DOCTYPE html>
<html lang="en-us">
<head prefix="og: http://ogp.me/ns#">
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1" />
  <meta property="og:title" content=" The machine learning pipeline and attacks &middot;  Embrace The Red" />
  
  <meta property="og:site_name" content="Embrace The Red" />
  <meta property="og:url" content="https://embracethered.com/blog/posts/2020/husky-ai-walkthrough/" />
  
  
  <meta property="og:type" content="article" />
  
  <meta property="og:article:published_time" content="2020-09-02T12:04:29-07:00" />
  
  <meta property="og:article:tag" content="machine learning" />
  
  <meta property="og:article:tag" content="huskyai" />
  
  

  <title>
     The machine learning pipeline and attacks &middot;  Embrace The Red
  </title>

  <link rel="stylesheet" href="https://embracethered.com/blog/css/bootstrap.min.css" />
  <link rel="stylesheet" href="https://embracethered.com/blog/css/main.css" />
  <link rel="stylesheet" href="https://embracethered.com/blog/css/font-awesome.min.css" />
  <link rel="stylesheet" href="https://embracethered.com/blog/css/github.css" />
  
  <link rel="stylesheet" href="https://embracethered.com/blog/fonts/cachedfonts.css" type="text/css">
  <link rel="shortcut icon" type="image/x-icon" href="https://embracethered.com/blog/images/favicon.ico" />
  <link rel="apple-touch-icon" type="image/x-icon" href="https://embracethered.com/blog/images/favicon.ico" />
  

  

  
</head>
<body>
    <header class="global-header"  style="background-image:url( /blog/images/bg.png )">
    <section class="header-text">
      <h1><a href="https://embracethered.com/blog/">Embrace The Red</a></h1>
      
      <div class="tag-line" style="min-width:fit-content; font-weight: 400;">
        wunderwuzzi&#39;s blog
        <br><div style="color: greenyellow; font-weight:400;">learn the hacks, stop the attacks.</div> 
      </div>
      
      <div class="sns-links hidden-print">
  
  <a href="mailto:security@wunderwuzzi.net">
    <i class="fa fa-envelope"></i>
  </a>
  
  
  <a href="https://twitter.com/wunderwuzzi23" target="_blank">
    <i class="fa fa-twitter"></i>
  </a>
  
  
  
  
  
  <a href="https://github.com/wunderwuzzi23" target="_blank">
    <i class="fa fa-github"></i>
  </a>
  
  
  
  
  
  <a href="https://youtube.com/@embracethered" target="_blank">
    <i class="fa fa-youtube"></i>
  </a>
  
  
  
  <a href="/blog/index.xml" target="_blank">
    <i class="fa fa-rss"></i>
  </a>
</div>

      
      <a href="https://embracethered.com/blog/" class="btn-header btn-back hidden-xs">
        <i class="fa fa-angle-left" aria-hidden="true"></i>
        &nbsp;Home
      </a>
      
    
      <a href="/blog/index.xml" class="btn-header btn-subscribe hidden-xs">
        <i class="fa fa-rss" aria-hidden="true"></i>
        &nbsp;Subscribe
      </a>
    </section>
  </header>
  <main class="container">


<article>
  <header>
    <h1 class="text-primary">The machine learning pipeline and attacks</h1>
    <div class="post-meta clearfix">
    
      <div class="post-date pull-left">
        Posted on
        <time datetime="2020-09-02T12:04:29-07:00">
          Sep 2, 2020
        </time>
      </div>
    
      <div class="pull-right">
        
        <span class="post-tag small"><a href="https://embracethered.com/blog//tags/machine-learning">#machine learning</a></span>
        
        <span class="post-tag small"><a href="https://embracethered.com/blog//tags/huskyai">#huskyai</a></span>
        
      </div>
    </div>
  </header>
  <section>
    <p>This post is part of a <a href="/blog/posts/2020/machine-learning-attack-series-overview/">series</a> about machine learning and artificial intelligence.</p>
<p>In the <a href="/blog/posts/2020/machine-learning-basics/">previous post</a> I talked about good resources for learning more about artificial intelligence and machine learning in general, and how I started my journey in this space.</p>
<p>The next few posts will be about Husky AI.</p>
<h2 id="what-is-husky-ai">What is Husky AI?</h2>
<p>Husky AI allows a user to upload an image, and get an answer back if the image contains a husky or not. Below is a screenshot of the application:</p>
<p><a href="/blog/images/2020/husky-ai.jpg"><img src="/blog/images/2020/husky-ai.jpg" alt="Husky AI"></a></p>
<p>If you watched the show &ldquo;Silicon Valley&rdquo;, you might find this quite funny.</p>
<h2 id="what-will-be-covered">What will be covered?</h2>
<p>In the next few posts I will describe how I built and operationalized &ldquo;Husky AI&rdquo;, which is a playground application I use to learn about machine learning and perform attacks.</p>
<ol>
<li><a href="/blog/posts/2020/husky-ai-walkthrough/"><strong>Machine Learning Pipeline</strong></a> - High Level overview of the bits and pieces (this post)</li>
<li><a href="/blog/posts/2020/husky-ai-building-the-machine-learning-model/"><strong>Building a machine learning model</strong></a> - The steps involved in building Husky AI model and training it</li>
<li><a href="/blog/posts/2020/husky-ai-mlops-operationalize-the-model/"><strong>Operationalizing the model</strong></a> - how did I make the model invokable from a web site</li>
<li><a href="/blog/posts/2020/husky-ai-threat-modeling-machine-learning/"><strong>Threat modeling the system</strong></a> - Identifying threats and attacks, with a focus on the AI/ML threats</li>
</ol>
<p>Let&rsquo;s get started with an overview of the machine learning pipeline. This will already highlight many of the moving pieces that can be attacked!</p>
<h1 id="part1">Part 1 - The Machine learning pipeline</h1>
<p>I assume that the reader is familiar with security and pen testing, but less so with machine learning.</p>
<p>The following image shows the main components of the machine learning pipeline:</p>
<p><a href="/blog/images/2020/machine-learning-pipeline.jpg"><img src="/blog/images/2020/machine-learning-pipeline.jpg" alt="Husky Machine Learning Pipeline"></a></p>
<p>This overview of the machine learning pipeline will eventually help us build a data flow diagram (DFD) that we use to identify threats and attacks later on.</p>
<p>Let&rsquo;s briefly describe the main parts of the ML pipeline of the &ldquo;Husky AI&rdquo; service:</p>
<ol>
<li><strong>Collecting training and validation images:</strong> The process starts with gathering images. These are pictures of huskies and random other pictures.</li>
<li><strong>Pre-Processing:</strong> The images go through some pre-processing steps (this includes data cleansing, rescaling, labeling, storing,..)</li>
<li><strong>Defining the initial model:</strong> We have to start somewhere, my very first test was a network with a single neuron (basically just logistic regression). At this point it is also <strong>important to set a measurable metric</strong> that can be used to compare training runs with each other. This is to be able to meaningfully improve the model</li>
<li><strong>Training the model</strong></li>
<li><strong>Evaluation:</strong> After a training (even during) measure performance of the model (e.g. accuracy)</li>
<li><strong>Improve the model:</strong> If performance is not met, update the model (e.g. trying different algorithms, learning rates, neural network layouts,&hellip;) and start training again</li>
<li><strong>Deployment:</strong> If the performance of the model looks good, deploy to production</li>
<li><strong>Operationalization:</strong> Make the model available for usage via an HTTP API. In my production deployment there is an API gateway which routes traffic to the Husky AI web server. The API endpoint then calls into the model give predictions for uploaded images</li>
<li><strong>End user runs predictions:</strong> A user can invoke the public API to upload an image and get a prediction</li>
<li><strong>(Online Feedback Loop)</strong>: Not visible in the image, because Husky AI does not do that. Production systems typically collect user data and feed it back into the pipeline (Step 1) - this turns the pipeline into an &ldquo;AI lifecycle&rdquo;.</li>
</ol>
<p>That&rsquo;s it. Those are the core pieces of a machine learning pipeline.</p>
<p>In <a href="/blog/posts/2020/husky-ai-building-the-machine-learning-model/">next post</a> we cover the technical details on how the Husky AI machine learning model was built and trained.</p>
<p>Twitter: <a href="https://twitter.com/wunderwuzzi23">@wunderwuzzi23</a></p>

  </section>
  <footer>
    
    
    
    <footer></footer><hr/>
    
    <ul class="pager">
      
      <li class="next"><a href="https://embracethered.com/blog/posts/2020/husky-ai-building-the-machine-learning-model/">Newer <span aria-hidden="true">&rarr;</span></a></li>
      
      
      <li class="author-contact">
        <a href="mailto:security@wunderwuzzi.net">
          <i class="fa fa-envelope-o" aria-hidden="true"></i>
          &nbsp;Contact me
        </a>
     </li>

      
      
      <li class="previous"><a href="https://embracethered.com/blog/posts/2020/machine-learning-basics/"><span aria-hidden="true">&larr;</span> Older</a></li>
      
    </ul>
  </footer>
</article>
</main>
  <footer class="container global-footer">
    <div class="copyright-note pull-left">
     
     (c) WUNDERWUZZI 2018-2025
     <div class="sns-links hidden-print">
  
  <a href="mailto:security@wunderwuzzi.net">
    <i class="fa fa-envelope"></i>
  </a>
  
  
  <a href="https://twitter.com/wunderwuzzi23" target="_blank">
    <i class="fa fa-twitter"></i>
  </a>
  
  
  
  
  
  <a href="https://github.com/wunderwuzzi23" target="_blank">
    <i class="fa fa-github"></i>
  </a>
  
  
  
  
  
  <a href="https://youtube.com/@embracethered" target="_blank">
    <i class="fa fa-youtube"></i>
  </a>
  
  
  
  <a href="/blog/index.xml" target="_blank">
    <i class="fa fa-rss"></i>
  </a>
</div>
 
     <div style="font-size:small;font-style: italic;color:crimson">
    Disclaimer: Penetration testing requires authorization from proper stakeholders. Information on this blog is provided for research and educational purposes to advance understanding of attacks and countermeasures to help secure the Internet. 
    </div>
    </div>
</footer>
  <script src="https://embracethered.com/blog/js/highlight.pack.js"></script>
  <script>
    hljs.initHighlightingOnLoad();
  </script>
  
  



<script type="text/javascript">
  var _paq = window._paq || [];
  _paq.push(["disableCookies"]);
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="//wuzzi.net/anamato/inc/";
    _paq.push(['setTrackerUrl', u+'rts.php']);
    _paq.push(['setSiteId', '1']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'rts.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<img src="https://wuzzi.net/anamato/inc/rts.php?idsite=1&amp;rec=1" style="border:0;" alt="" />
  
</body>
</html>

