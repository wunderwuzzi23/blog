<!DOCTYPE html>
<html lang="en-us">
<head prefix="og: http://ogp.me/ns#">
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1" />
  <meta property="og:title" content=" $3000 Bug Bounty Award from Mozilla for a successful targeted Credential Hunt &middot;  Embrace The Red" />
  
  <meta property="og:site_name" content="Embrace The Red" />
  <meta property="og:url" content="https://embracethered.com/blog/posts/2020/mozilla-bug-bounty-credential-hunt-phabricator-token/" />
  
  
  <meta property="og:type" content="article" />
  
  <meta property="og:article:published_time" content="2020-05-13T18:00:25-07:00" />
  
  <meta property="og:article:tag" content="red" />
  
  <meta property="og:article:tag" content="ttp" />
  
  <meta property="og:article:tag" content="book" />
  
  <meta property="og:article:tag" content="bugbounty" />
  
  

  <title>
     $3000 Bug Bounty Award from Mozilla for a successful targeted Credential Hunt &middot;  Embrace The Red
  </title>

  <link rel="stylesheet" href="https://embracethered.com/blog/css/bootstrap.min.css" />
  <link rel="stylesheet" href="https://embracethered.com/blog/css/main.css" />
  <link rel="stylesheet" href="https://embracethered.com/blog/css/font-awesome.min.css" />
  <link rel="stylesheet" href="https://embracethered.com/blog/css/github.css" />
  
  <link rel="stylesheet" href="https://embracethered.com/blog/fonts/cachedfonts.css" type="text/css">
  <link rel="shortcut icon" type="image/x-icon" href="https://embracethered.com/blog/images/favicon.ico" />
  <link rel="apple-touch-icon" type="image/x-icon" href="https://embracethered.com/blog/images/favicon.ico" />
  

  

  
</head>
<body>
    <header class="global-header"  style="background-image:url( /blog/images/bg.png )">
    <section class="header-text">
      <h1><a href="https://embracethered.com/blog/">Embrace The Red</a></h1>
      
      <div class="tag-line" style="min-width:fit-content; font-weight: 400;">
        wunderwuzzi&#39;s blog
        <br><div style="color: greenyellow; font-weight:400;">learn the hacks, stop the attacks.</div> 
      </div>
      
      <div class="sns-links hidden-print">
  
  <a href="mailto:security@wunderwuzzi.net">
    <i class="fa fa-envelope"></i>
  </a>
  
  
  <a href="https://twitter.com/wunderwuzzi23" target="_blank">
    <i class="fa fa-twitter"></i>
  </a>
  
  
  
  
  
  <a href="https://github.com/wunderwuzzi23" target="_blank">
    <i class="fa fa-github"></i>
  </a>
  
  
  
  
  
  <a href="https://youtube.com/@embracethered" target="_blank">
    <i class="fa fa-youtube"></i>
  </a>
  
  
  
  <a href="/blog/index.xml" target="_blank">
    <i class="fa fa-rss"></i>
  </a>
</div>

      
      <a href="https://embracethered.com/blog/" class="btn-header btn-back hidden-xs">
        <i class="fa fa-angle-left" aria-hidden="true"></i>
        &nbsp;Home
      </a>
      
    
      <a href="/blog/index.xml" class="btn-header btn-subscribe hidden-xs">
        <i class="fa fa-rss" aria-hidden="true"></i>
        &nbsp;Subscribe
      </a>
    </section>
  </header>
  <main class="container">


<article>
  <header>
    <h1 class="text-primary">$3000 Bug Bounty Award from Mozilla for a successful targeted Credential Hunt</h1>
    <div class="post-meta clearfix">
    
      <div class="post-date pull-left">
        Posted on
        <time datetime="2020-05-13T18:00:25-07:00">
          May 13, 2020
        </time>
      </div>
    
      <div class="pull-right">
        
        <span class="post-tag small"><a href="https://embracethered.com/blog//tags/red">#red</a></span>
        
        <span class="post-tag small"><a href="https://embracethered.com/blog//tags/ttp">#ttp</a></span>
        
        <span class="post-tag small"><a href="https://embracethered.com/blog//tags/book">#book</a></span>
        
        <span class="post-tag small"><a href="https://embracethered.com/blog//tags/bugbounty">#bugbounty</a></span>
        
      </div>
    </div>
  </header>
  <section>
    <p>Last month I did some research on Firefox, specifically I was learning more about it&rsquo;s remote debugging features. As part of that I was reading Bugzilla bug information and learned more about Mozilla&rsquo;s infrastructure.</p>
<p>One thing I noticed reading up on details was that Mozilla uses <strong>Phabricator</strong>.</p>
<h3 id="what-is-phabricator">What is Phabricator?</h3>
<p><strong>Phabricator</strong> is a collaborative web-based toolset for code reviews, checkins, bugs, work items, wiki, pastes, credentials and many other useful things. It was orginally developed by Facebook as far as I know.</p>
<h3 id="api-tokens">API Tokens</h3>
<p>From past red teaming experience I know that its common for developers to create API tokens for command line usage to interact with Phabricator.</p>
<p>There is a tool called <strong>arcanist</strong> that is  used to perform checkins via <code>arc land</code> and so forth. These tokens usually start with <code>api-</code> or <code>cli-</code> followed by number of random characters.</p>
<p><strong>Mozilla actively encourages security research and bounty hunting to help improve the security posture of their software and services.</strong></p>
<p><a href="https://www.mozilla.org/en-US/security/bug-bounty/">Here</a> an excerpt from Mozilla&rsquo;s bug bounty page:</p>
<blockquote>
<p>Mozilla strongly supports security research into our products and wants to encourage that research.</p>
</blockquote>
<p>Equipped with this intel and knowing that Mozilla encourages security research, I decided to perform a <strong>targeted Phabricator Credential Hunt</strong> for Mozilla.</p>
<h3 id="targeted-credential-hunting">Targeted Credential Hunting</h3>
<p><strong><a href="/blog/posts/2020/hunting-for-credentials">Credential Hunting</a></strong> is a dedicated and <strong>targeted activity</strong> that I recommend performing during red teaming and penetration testing. After gaining some basic intel about systems used and what to specifically look for, targeted credential hunting can be fruitful.</p>
<p>Using the information and techniques from the previous post about Credential Hunting and related ones described in my book, <strong>I had identified a valid Mozilla Phabricator API token, along with a Bugzilla token</strong> in a Github repo.</p>
<h3 id="token-validation">Token Validation</h3>
<p>To validate the token, I used the Phabricator <strong>whoami</strong> API.</p>
<pre tabindex="0"><code>curl https://&lt;phabricator&gt;/api/user.whoami -d api.token=api-xxxx
</code></pre><p>The response of the request showed that the token impersonated a Mozilla account. At that point I knew, what I needed to know - there was no need to perform any other action.</p>
<h3 id="reporting">Reporting</h3>
<p><strong>I promptly reported this issue to Mozilla and they fixed it basically immediatley</strong>. They also performed investigations to ensure no misuse had occured and searched for variants.</p>
<p>It was impressive to watch Mozilla&rsquo;s professionalism during the response.</p>
<h3 id="the-power-of-credential-hunting">The power of credential hunting</h3>
<p>This is an example to show how useful it is to perform <strong>active and targeted credential hunts</strong> for your clients or organization. Tokens often are out there but automated scanning tools might not be able to identify or validate them yet (because of parsing or lack of intel, or other reasons).</p>
<p><strong>Mozilla awarded a $3000 bug bounty reward for this. :)</strong></p>
<h3 id="red-team-strategies">Red Team Strategies</h3>
<p>If you liked this post and found it informative or inspirational, you might be interested in my book <a href="https://www.amazon.com/gp/product/1838828869/ref=as_li_tl?ie=UTF8&amp;tag=wunderwuzzi-20&amp;camp=1789&amp;creative=9325&amp;linkCode=as2&amp;creativeASIN=1838828869&amp;linkId=07bfd6b729fbc2b2904160e0e16c337f">&ldquo;Cybersecurity Attacks - Red Team Strategies&rdquo;</a>. It is filled with further ideas, research and fundamental techniques, as well as red teaming program and people mangement aspects.</p>
<p>Also, feel free to follow or DM me on Twitter: <a href="https://twitter.com/wunderwuzzi23">@wunderwuzzi23</a></p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://www.mozilla.org/en-US/security/bug-bounty/">Mozilla Bug Bounty</a></li>
<li><a href="https://github.com/wunderwuzzi23/scratch/blob/master/creds.md">Credentials Reference - Markdown</a></li>
<li><a href="https://github.com/wunderwuzzi23/scratch/blob/master/creds.csv">Credentials Reference - CSV</a></li>
<li><a href="https://phacility.com/phabricator">Phabricator</a></li>
</ul>
<p><img src="/blog/images/2020/hacker.png" alt="Hacker"></p>

  </section>
  <footer>
    
    
    
    <footer></footer><hr/>
    
    <ul class="pager">
      
      <li class="next"><a href="https://embracethered.com/blog/posts/2020/phishing-stats/">Newer <span aria-hidden="true">&rarr;</span></a></li>
      
      
      <li class="author-contact">
        <a href="mailto:security@wunderwuzzi.net">
          <i class="fa fa-envelope-o" aria-hidden="true"></i>
          &nbsp;Contact me
        </a>
     </li>

      
      
      <li class="previous"><a href="https://embracethered.com/blog/posts/2020/cookie-crimes-on-mirosoft-edge/"><span aria-hidden="true">&larr;</span> Older</a></li>
      
    </ul>
  </footer>
</article>
</main>
  <footer class="container global-footer">
    <div class="copyright-note pull-left">
     
     (c) WUNDERWUZZI 2018-2025
     <div class="sns-links hidden-print">
  
  <a href="mailto:security@wunderwuzzi.net">
    <i class="fa fa-envelope"></i>
  </a>
  
  
  <a href="https://twitter.com/wunderwuzzi23" target="_blank">
    <i class="fa fa-twitter"></i>
  </a>
  
  
  
  
  
  <a href="https://github.com/wunderwuzzi23" target="_blank">
    <i class="fa fa-github"></i>
  </a>
  
  
  
  
  
  <a href="https://youtube.com/@embracethered" target="_blank">
    <i class="fa fa-youtube"></i>
  </a>
  
  
  
  <a href="/blog/index.xml" target="_blank">
    <i class="fa fa-rss"></i>
  </a>
</div>
 
     <div style="font-size:small;font-style: italic;color:crimson">
    Disclaimer: Penetration testing requires authorization from proper stakeholders. Information on this blog is provided for research and educational purposes to advance understanding of attacks and countermeasures to help secure the Internet. 
    </div>
    </div>
</footer>
  <script src="https://embracethered.com/blog/js/highlight.pack.js"></script>
  <script>
    hljs.initHighlightingOnLoad();
  </script>
  
  



<script type="text/javascript">
  var _paq = window._paq || [];
  _paq.push(["disableCookies"]);
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="//wuzzi.net/anamato/inc/";
    _paq.push(['setTrackerUrl', u+'rts.php']);
    _paq.push(['setSiteId', '1']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'rts.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<img src="https://wuzzi.net/anamato/inc/rts.php?idsite=1&amp;rec=1" style="border:0;" alt="" />
  
</body>
</html>

